<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Earth magnetic declination, inclination, and intensity — magneticField • oce</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Earth magnetic declination, inclination, and intensity — magneticField" />
<meta property="og:description" content="Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see reference 1)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/oce.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dankelley/oce/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Earth magnetic declination, inclination, and intensity</h1>
    <small class="dont-index">Source: <a href='https://github.com/dankelley/oce/blob/master/R/misc.R'><code>R/misc.R</code></a></small>
    <div class="hidden name"><code>magneticField.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see reference 1).</p>
    </div>

    <pre class="usage"><span class='fu'>magneticField</span>(<span class='no'>longitude</span>, <span class='no'>latitude</span>, <span class='no'>time</span>, <span class='kw'>version</span> <span class='kw'>=</span> <span class='fl'>13</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>longitude</th>
      <td><p>longitude in degrees east (negative for degrees west).  The
dimensions must conform to lat.</p></td>
    </tr>
    <tr>
      <th>latitude</th>
      <td><p>latitude in degrees north, a number, vector, or matrix.</p></td>
    </tr>
    <tr>
      <th>time</th>
      <td><p>The time at which the field is desired. This may be a
single value or a vector or matrix that is structured to match
<code>longitude</code> and <code>latitude</code>. The value may a decimal year,
a POSIXt time, or a Date time.</p></td>
    </tr>
    <tr>
      <th>version</th>
      <td><p>an integer that must be either 12 or 13, to specify
the version number of the formulae. Note that 13 became the default
on 2020 March 3, so to old code will need to specify <code>version=12</code>
to work as it did before that date.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list containing <code>declination</code>, <code>inclination</code>, and
<code>intensity</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The code (subroutines <code>igrf12syn</code> and <code>igrf13syn</code>) seem to have
been written by Susan Macmillan of the British Geological Survey.  Comments
in the source code <code>igrf13syn</code> (the current default used here)
indicate that its coefficients were agreed to in
December 2019 by the IAGA Working Group V-MOD.  Other comments in that code
suggest that the proposed application time interval is from years 1900 to 2025, inclusive,
but that only dates from 1945 to 2015 are to be considered definitive.</p>
    <h2 class="hasAnchor" id="historical-notes"><a class="anchor" href="#historical-notes"></a>Historical Notes</h2>

    

<p>For about a decade, <code>magneticField</code> used the version 12 formulae provided
by IAGA, but the code was updated on March 3, 2020, to version 13.  Example
3 shows that the differences in declination are typicaly under 2 degrees
(with 95 percent of the data lying between -1.7 and 0.7 degrees).</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>The underlying Fortran code for version 12 is from <code>igrf12.f</code>, downloaded the NOAA
website (<a href='https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html'>https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</a>) on June 7,</p></li>
<li><p>That for version 13 is <code>igrf13.f</code>, downloadd from the NOAA website
(<a href='https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html'>https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</a> on March 3, 2020.</p></li>
<li><p>Witze, Alexandra. &#8220;Earth's Magnetic Field Is Acting up and Geologists Don't Know Why.&#8221;
Nature 565 (January 9, 2019): 143.
<a href='https://doi.org/10.1038/d41586-019-00007-1'>https://doi.org/10.1038/d41586-019-00007-1</a>.</p></li>
</ol>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other things related to magnetism: 
<code><a href='applyMagneticDeclination.html'>applyMagneticDeclination</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>oce</span>)
<span class='co'># 1. Today's value at Halifax NS</span>
<span class='fu'>magneticField</span>(-(<span class='fl'>63</span>+<span class='fl'>36</span>/<span class='fl'>60</span>), <span class='fl'>44</span>+<span class='fl'>39</span>/<span class='fl'>60</span>, <span class='fu'><a href='https://rdrr.io/r/base/Sys.time.html'>Sys.Date</a></span>())</div><div class='output co'>#&gt; $declination
#&gt; [1] -16.94125
#&gt; 
#&gt; $inclination
#&gt; [1] 66.85609
#&gt; 
#&gt; $intensity
#&gt; [1] 51501.39
#&gt; </div><div class='input'>
<span class='co'># 2. World map of declination in year 2000.</span>
<span class='co'># \donttest{</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>coastlineWorld</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/rep.html'>rep</a></span>(<span class='fl'>0.5</span>, <span class='fl'>4</span>)) <span class='co'># no axes on whole-world projection</span>
<span class='fu'><a href='mapPlot.html'>mapPlot</a></span>(<span class='no'>coastlineWorld</span>, <span class='kw'>projection</span><span class='kw'>=</span><span class='st'>"+proj=robin"</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>"lightgray"</span>)</div><div class='input'><span class='co'># Construct matrix holding declination</span>
<span class='no'>lon</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>180</span>, <span class='fl'>180</span>)
<span class='no'>lat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>90</span>, <span class='fl'>90</span>)
<span class='no'>dec2000</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>lon</span>, <span class='no'>lat</span>)
    <span class='fu'>magneticField</span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='fl'>2000</span>)$<span class='no'>declination</span>
<span class='no'>dec</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec2000</span>) <span class='co'># hint: outer() is very handy!</span>
<span class='co'># Contour, unlabelled for small increments, labeled for</span>
<span class='co'># larger increments.</span>
<span class='fu'><a href='mapContour.html'>mapContour</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>'blue'</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>180</span>, -<span class='fl'>5</span>, <span class='fl'>5</span>),
           <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>drawlabels</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='input'><span class='fu'><a href='mapContour.html'>mapContour</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>'blue'</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>180</span>, -<span class='fl'>20</span>, <span class='fl'>20</span>))</div><div class='input'><span class='fu'><a href='mapContour.html'>mapContour</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>5</span>, <span class='fl'>180</span>, <span class='fl'>5</span>),
           <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>3</span>, <span class='kw'>drawlabels</span><span class='kw'>=</span><span class='fl'>FALSE</span>)</div><div class='input'><span class='fu'><a href='mapContour.html'>mapContour</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>'red'</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(<span class='fl'>20</span>, <span class='fl'>180</span>, <span class='fl'>20</span>))</div><div class='input'><span class='fu'><a href='mapContour.html'>mapContour</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fl'>180</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>'black'</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>, <span class='kw'>drawlabels</span><span class='kw'>=</span><span class='fl'>FALSE</span>)
<span class='fu'><a href='mapContour.html'>mapContour</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>dec</span>, <span class='kw'>levels</span><span class='kw'>=</span><span class='fl'>0</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='st'>'black'</span>, <span class='kw'>lwd</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='img'><img src='magneticField-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>

<span class='co'># 3. Declination differences between versions 12 and 13</span>
<span class='co'># \donttest{</span>
<span class='no'>lon</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>180</span>, <span class='fl'>180</span>)
<span class='no'>lat</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>90</span>, <span class='fl'>90</span>)
<span class='no'>decDiff</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>lon</span>, <span class='no'>lat</span>) {
    <span class='no'>old</span> <span class='kw'>&lt;-</span> <span class='fu'>magneticField</span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='fl'>2020</span>, <span class='kw'>version</span><span class='kw'>=</span><span class='fl'>13</span>)$<span class='no'>declination</span>
    <span class='no'>new</span> <span class='kw'>&lt;-</span> <span class='fu'>magneticField</span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='fl'>2020</span>, <span class='kw'>version</span><span class='kw'>=</span><span class='fl'>12</span>)$<span class='no'>declination</span>
    <span class='no'>new</span> - <span class='no'>old</span>
}
<span class='no'>decDiff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/outer.html'>outer</a></span>(<span class='no'>lon</span>, <span class='no'>lat</span>, <span class='no'>decDiff</span>)
<span class='no'>decDiff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/ifelse.html'>ifelse</a></span>(<span class='no'>decDiff</span> <span class='kw'>&gt;</span> <span class='fl'>180</span>, <span class='no'>decDiff</span> - <span class='fl'>360</span>, <span class='no'>decDiff</span>)
<span class='co'># Overall (mean) shift -0.1deg</span>
<span class='fu'><a href='https://rdrr.io/r/stats/t.test.html'>t.test</a></span>(<span class='no'>decDiff</span>)</div><div class='output co'>#&gt; 
#&gt; 	One Sample t-test
#&gt; 
#&gt; data:  decDiff
#&gt; t = -21.794, df = 65340, p-value &lt; 2.2e-16
#&gt; alternative hypothesis: true mean is not equal to 0
#&gt; 95 percent confidence interval:
#&gt;  -0.10399320 -0.08683188
#&gt; sample estimates:
#&gt;   mean of x 
#&gt; -0.09541254 
#&gt; </div><div class='input'><span class='co'># View histogram, narrowed to small differences</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3.5</span>, <span class='fl'>3.5</span>, <span class='fl'>2</span>, <span class='fl'>2</span>), <span class='kw'>mgp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>0.7</span>, <span class='fl'>0</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/hist.html'>hist</a></span>(<span class='no'>decDiff</span>, <span class='kw'>breaks</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/seq.html'>seq</a></span>(-<span class='fl'>180</span>, <span class='fl'>180</span>, <span class='fl'>0.05</span>), <span class='kw'>xlim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>2</span>, <span class='fl'>2</span>),
     <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Declination difference [deg] from version=12 to version=13"</span>,
     <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Predictions for year 2020"</span>)</div><div class='img'><img src='magneticField-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='fu'><a href='https://rdrr.io/r/stats/quantile.html'>quantile</a></span>(<span class='no'>decDiff</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0.025</span>, <span class='fl'>0.975</span>)))</div><div class='output co'>#&gt;       2.5%      97.5% 
#&gt; -1.6695352  0.7159345 </div><div class='input'><span class='co'># Note that the large differences are at high latitudes</span>
<span class='fu'><a href='imagep.html'>imagep</a></span>(<span class='no'>lon</span>,<span class='no'>lat</span>,<span class='no'>decDiff</span>, <span class='kw'>zlim</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(-<span class='fl'>1</span>,<span class='fl'>1</span>)*<span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/MathFun.html'>abs</a></span>(<span class='no'>decDiff</span>)))</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>coastlineWorld</span><span class='kw'>[[</span><span class='st'>"longitude"</span>]], <span class='no'>coastlineWorld</span><span class='kw'>[[</span><span class='st'>"latitude"</span>]])</div><div class='img'><img src='magneticField-3.png' alt='' width='700' height='433' /></div><div class='input'># }
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


