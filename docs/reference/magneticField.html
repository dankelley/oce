<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Earth magnetic declination, inclination, and intensity — magneticField • oce</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Earth magnetic declination, inclination, and intensity — magneticField"><meta property="og:description" content="Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see reference 1)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7-7</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A_oce.html">1. Introduction to Oce</a>
    </li>
    <li>
      <a href="../articles/B_ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/D_map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/E_flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/F_subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dankelley/oce/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Earth magnetic declination, inclination, and intensity</h1>
    <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/misc.R" class="external-link"><code>R/misc.R</code></a></small>
    <div class="hidden name"><code>magneticField.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see reference 1).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">magneticField</span><span class="op">(</span><span class="va">longitude</span>, <span class="va">latitude</span>, <span class="va">time</span>, version <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>longitude</dt>
<dd><p>longitude in degrees east (negative for degrees west).  The
dimensions must conform to lat.</p></dd>


<dt>latitude</dt>
<dd><p>latitude in degrees north, a number, vector, or matrix.</p></dd>


<dt>time</dt>
<dd><p>The time at which the field is desired. This may be a
single value or a vector or matrix that is structured to match
<code>longitude</code> and <code>latitude</code>. The value may a decimal year,
a POSIXt time, or a Date time.</p></dd>


<dt>version</dt>
<dd><p>an integer that must be either 12 or 13, to specify
the version number of the formulae. Note that 13 became the default
on 2020 March 3, so to old code will need to specify <code>version=12</code>
to work as it did before that date.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>A list containing <code>declination</code>, <code>inclination</code>, and
<code>intensity</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The code (subroutines <code>igrf12syn</code> and <code>igrf13syn</code>) seem to have
been written by Susan Macmillan of the British Geological Survey.  Comments
in the source code <code>igrf13syn</code> (the current default used here)
indicate that its coefficients were agreed to in
December 2019 by the IAGA Working Group V-MOD.  Other comments in that code
suggest that the proposed application time interval is from years 1900 to 2025, inclusive,
but that only dates from 1945 to 2015 are to be considered definitive.</p>
    </div>
    <div id="historical-notes">
    <h2>Historical Notes</h2>
    

<p>For about a decade, <code>magneticField</code> used the version 12 formulae provided
by IAGA, but the code was updated on March 3, 2020, to version 13.  Example
3 shows that the differences in declination are typically under 2 degrees
(with 95 percent of the data lying between -1.7 and 0.7 degrees).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>The underlying Fortran code for version 12 is from <code>igrf12.f</code>, downloaded the NOAA
website (<code>https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</code>) on June 7,</p></li>
<li><p>That for version 13 is <code>igrf13.f</code>, downloaded from the NOAA website
(<code>https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</code> on March 3, 2020.</p></li>
<li><p>Witze, Alexandra. “Earth's Magnetic Field Is Acting up and Geologists Don't Know Why.”
Nature 565 (January 9, 2019): 143.
<a href="https://doi.org/10.1038/d41586-019-00007-1" class="external-link">doi:10.1038/d41586-019-00007-1</a></p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other things related to magnetism: 
<code><a href="applyMagneticDeclination.html">applyMagneticDeclination</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Dan Kelley wrote the R code and a fortran wrapper to the
<code>igrf12.f</code> subroutine, which was written by Susan Macmillan of the
British Geological Survey and distributed ``without limitation'' (email from
SM to DK dated June 5, 2015).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># 1. Today's value at Halifax NS</span></span>
<span class="r-in"><span class="fu">magneticField</span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">63</span><span class="op">+</span><span class="fl">36</span><span class="op">/</span><span class="fl">60</span><span class="op">)</span>, <span class="fl">44</span><span class="op">+</span><span class="fl">39</span><span class="op">/</span><span class="fl">60</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $declination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -16.64187</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inclination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 66.6384</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 51355.48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 2. World map of declination in year 2000.</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coastlineWorld</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># no axes on whole-world projection</span></span>
<span class="r-in"><span class="fu"><a href="mapPlot.html">mapPlot</a></span><span class="op">(</span><span class="va">coastlineWorld</span>, projection<span class="op">=</span><span class="st">"+proj=robin"</span>, col<span class="op">=</span><span class="st">"lightgray"</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Construct matrix holding declination</span></span>
<span class="r-in"><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span></span>
<span class="r-in"><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span></span>
<span class="r-in"><span class="va">dec2000</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span></span>
<span class="r-in">    <span class="fu">magneticField</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fl">2000</span><span class="op">)</span><span class="op">$</span><span class="va">declination</span></span>
<span class="r-in"><span class="va">dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec2000</span><span class="op">)</span> <span class="co"># hint: outer() is very handy!</span></span>
<span class="r-in"><span class="co"># Contour, unlabelled for small increments, labeled for</span></span>
<span class="r-in"><span class="co"># larger increments.</span></span>
<span class="r-in"><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, col<span class="op">=</span><span class="st">'blue'</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">           lty<span class="op">=</span><span class="fl">3</span>, drawlabels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, col<span class="op">=</span><span class="st">'blue'</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, col<span class="op">=</span><span class="st">'red'</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">180</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span class="r-in">           lty<span class="op">=</span><span class="fl">3</span>, drawlabels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, col<span class="op">=</span><span class="st">'red'</span>, levels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">180</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, levels<span class="op">=</span><span class="fl">180</span>, col<span class="op">=</span><span class="st">'black'</span>, lwd<span class="op">=</span><span class="fl">2</span>, drawlabels<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, levels<span class="op">=</span><span class="fl">0</span>, col<span class="op">=</span><span class="st">'black'</span>, lwd<span class="op">=</span><span class="fl">2</span><span class="op">)</span></span>
<span class="r-plt img"><img src="magneticField-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 3. Declination differences between versions 12 and 13</span></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span></span>
<span class="r-in"><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span></span>
<span class="r-in"><span class="va">decDiff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in">    <span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">magneticField</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fl">2020</span>, version<span class="op">=</span><span class="fl">13</span><span class="op">)</span><span class="op">$</span><span class="va">declination</span></span>
<span class="r-in">    <span class="va">new</span> <span class="op">&lt;-</span> <span class="fu">magneticField</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fl">2020</span>, version<span class="op">=</span><span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">declination</span></span>
<span class="r-in">    <span class="va">new</span> <span class="op">-</span> <span class="va">old</span></span>
<span class="r-in"><span class="op">}</span></span>
<span class="r-in"><span class="va">decDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">decDiff</span><span class="op">)</span></span>
<span class="r-in"><span class="va">decDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">decDiff</span> <span class="op">&gt;</span> <span class="fl">180</span>, <span class="va">decDiff</span> <span class="op">-</span> <span class="fl">360</span>, <span class="va">decDiff</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># Overall (mean) shift -0.1deg</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">decDiff</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	One Sample t-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  decDiff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = -21.794, df = 65340, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true mean is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.10399320 -0.08683188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean of x </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.09541254 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span class="co"># View histogram, narrowed to small differences</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">decDiff</span>, breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, <span class="fl">0.05</span><span class="op">)</span>, xlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span>
<span class="r-in">     xlab<span class="op">=</span><span class="st">"Declination difference [deg] from version=12 to version=13"</span>,</span>
<span class="r-in">     main<span class="op">=</span><span class="st">"Predictions for year 2020"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="magneticField-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">decDiff</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2.5%      97.5% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.6695352  0.7159345 </span>
<span class="r-in"><span class="co"># Note that the large differences are at high latitudes</span></span>
<span class="r-in"><span class="fu"><a href="imagep.html">imagep</a></span><span class="op">(</span><span class="va">lon</span>,<span class="va">lat</span>,<span class="va">decDiff</span>, zlim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">decDiff</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">coastlineWorld</span><span class="op">[[</span><span class="st">"longitude"</span><span class="op">]</span><span class="op">]</span>, <span class="va">coastlineWorld</span><span class="op">[[</span><span class="st">"latitude"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-plt img"><img src="magneticField-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span class="co"># }</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer></div>

  


  

  </body></html>

