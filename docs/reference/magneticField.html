<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Earth Magnetic Declination, Inclination, and Intensity — magneticField • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Earth Magnetic Declination, Inclination, and Intensity — magneticField"><meta name="description" content="Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see &amp;#8220;References&amp;#8221;)."><meta property="og:description" content="Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see &amp;#8220;References&amp;#8221;)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Earth Magnetic Declination, Inclination, and Intensity</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/misc.R" class="external-link"><code>R/misc.R</code></a></small>
      <div class="d-none name"><code>magneticField.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implements the 12th and 13th generations of the
International Geomagnetic Reference Field
(IGRF), based on a reworked version of a Fortran program downloaded from a
NOAA website (see “References”).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">magneticField</span><span class="op">(</span><span class="va">longitude</span>, <span class="va">latitude</span>, <span class="va">time</span>, version <span class="op">=</span> <span class="fl">13</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-longitude">longitude<a class="anchor" aria-label="anchor" href="#arg-longitude"></a></dt>
<dd><p>longitude in degrees east (negative for degrees west), as a
number, a vector, or a matrix.</p></dd>


<dt id="arg-latitude">latitude<a class="anchor" aria-label="anchor" href="#arg-latitude"></a></dt>
<dd><p>latitude in degrees north, as a number, vector, or matrix.
The shape (length or dimensions) must conform to the dimensions of <code>longitude</code>.</p></dd>


<dt id="arg-time">time<a class="anchor" aria-label="anchor" href="#arg-time"></a></dt>
<dd><p>The time at which the field is desired. This may be a
single value or a vector or matrix that is structured to match
<code>longitude</code> and <code>latitude</code>. The value may a decimal year,
a POSIXt time, or a Date time.</p></dd>


<dt id="arg-version">version<a class="anchor" aria-label="anchor" href="#arg-version"></a></dt>
<dd><p>an integer that must be either 12 or 13, to specify
the version number of the formulae. Note that 13 became the default
on 2020 March 3, so to old code will need to specify <code>version=12</code>
to work as it did before that date.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing <code>declination</code>, <code>inclination</code>, and
<code>intensity</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The code (subroutines <code>igrf12syn</code> and <code>igrf13syn</code>) seem to have
been written by Susan Macmillan of the British Geological Survey.  Comments
in the source code <code>igrf13syn</code> (the current default used here)
indicate that its coefficients were agreed to in
December 2019 by the IAGA Working Group V-MOD.  Other comments in that code
suggest that the proposed application time interval is from years 1900 to 2025, inclusive,
but that only dates from 1945 to 2015 are to be considered definitive.</p>
    </div>
    <div class="section level2">
    <h2 id="historical-notes">Historical Notes<a class="anchor" aria-label="anchor" href="#historical-notes"></a></h2>


<p>For about a decade, <code>magneticField</code> used the version 12 formulae provided
by IAGA, but the code was updated on March 3, 2020, to version 13.  Example
3 shows that the differences in declination are typically under 2 degrees
(with 95 percent of the data lying between -1.7 and 0.7 degrees).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ol><li><p>The underlying Fortran code for version 12 is from <code>igrf12.f</code>, downloaded the NOAA
website (<code>https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</code>) on June 7,</p></li>
<li><p>That for version 13 is <code>igrf13.f</code>, downloaded from the NOAA website
(<code>https://www.ngdc.noaa.gov/IAGA/vmod/igrf.html</code> on March 3, 2020.</p></li>
<li><p>Witze, Alexandra. “Earth's Magnetic Field Is Acting up and Geologists Don't Know Why.”
Nature 565 (January 9, 2019): 143.
<a href="https://doi.org/10.1038/d41586-019-00007-1" class="external-link">doi:10.1038/d41586-019-00007-1</a></p></li>
<li><p>Alken, P., E. Thébault, C. D. Beggan, H. Amit, J. Aubert, J. Baerenzung, T. N. Bondar, et al.
"International Geomagnetic Reference Field: The Thirteenth Generation."
Earth, Planets and Space 73, no. 1 (December 2021): 49.
<a href="https://doi.org/10.1186/s40623-020-01288-x" class="external-link">doi:10.1186/s40623-020-01288-x</a>
.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other things related to magnetism:
<code><a href="applyMagneticDeclination.html">applyMagneticDeclination</a>()</code>,
<code><a href="applyMagneticDeclination-adp-method.html">applyMagneticDeclination,adp-method</a></code>,
<code><a href="applyMagneticDeclination-adv-method.html">applyMagneticDeclination,adv-method</a></code>,
<code><a href="applyMagneticDeclination-cm-method.html">applyMagneticDeclination,cm-method</a></code>,
<code><a href="applyMagneticDeclination-oce-method.html">applyMagneticDeclination,oce-method</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley wrote the R code and a fortran wrapper to the
<code>igrf12.f</code> subroutine, which was written by Susan Macmillan of the
British Geological Survey and distributed “without limitation” (email from
SM to DK dated June 5, 2015).  This version was updated subsequent
to that date; see “Historical Notes”.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># 1. Today's value at Halifax NS</span></span></span>
<span class="r-in"><span><span class="fu">magneticField</span><span class="op">(</span><span class="op">-</span><span class="op">(</span><span class="fl">63</span> <span class="op">+</span> <span class="fl">36</span> <span class="op">/</span> <span class="fl">60</span><span class="op">)</span>, <span class="fl">44</span> <span class="op">+</span> <span class="fl">39</span> <span class="op">/</span> <span class="fl">60</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.Date</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $declination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -16.33788</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $inclination</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 66.41279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $intensity</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 51206.52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. World map of declination in year 2000.</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">coastlineWorld</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span> <span class="co"># no axes on whole-world projection</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapPlot.html">mapPlot</a></span><span class="op">(</span><span class="va">coastlineWorld</span>, projection <span class="op">=</span> <span class="st">"+proj=robin"</span>, col <span class="op">=</span> <span class="st">"lightgray"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Construct matrix holding declination</span></span></span>
<span class="r-in"><span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dec2000</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">magneticField</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fl">2000</span><span class="op">)</span><span class="op">$</span><span class="va">declination</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">dec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec2000</span><span class="op">)</span> <span class="co"># hint: outer() is very handy!</span></span></span>
<span class="r-in"><span><span class="co"># Contour, unlabelled for small increments, labeled for</span></span></span>
<span class="r-in"><span><span class="co"># larger increments.</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">"blue"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    lty <span class="op">=</span> <span class="fl">3</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, col <span class="op">=</span> <span class="st">"blue"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="op">-</span><span class="fl">20</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="st">"red"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">180</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    lty <span class="op">=</span> <span class="fl">3</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, col <span class="op">=</span> <span class="st">"red"</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">180</span>, <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, levels <span class="op">=</span> <span class="fl">180</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span>, drawlabels <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="mapContour.html">mapContour</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">dec</span>, levels <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="magneticField-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3. Declination differences between versions 12 and 13</span></span></span>
<span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="va">lon</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">90</span>, <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">decDiff</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">old</span> <span class="op">&lt;-</span> <span class="fu">magneticField</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fl">2020</span>, version <span class="op">=</span> <span class="fl">13</span><span class="op">)</span><span class="op">$</span><span class="va">declination</span></span></span>
<span class="r-in"><span>    <span class="va">new</span> <span class="op">&lt;-</span> <span class="fu">magneticField</span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="fl">2020</span>, version <span class="op">=</span> <span class="fl">12</span><span class="op">)</span><span class="op">$</span><span class="va">declination</span></span></span>
<span class="r-in"><span>    <span class="va">new</span> <span class="op">-</span> <span class="va">old</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">decDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">decDiff</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">decDiff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">decDiff</span> <span class="op">&gt;</span> <span class="fl">180</span>, <span class="va">decDiff</span> <span class="op">-</span> <span class="fl">360</span>, <span class="va">decDiff</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Overall (mean) shift -0.1deg</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/t.test.html" class="external-link">t.test</a></span><span class="op">(</span><span class="va">decDiff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 	One Sample t-test</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> data:  decDiff</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> t = -21.794, df = 65340, p-value &lt; 2.2e-16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alternative hypothesis: true mean is not equal to 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 95 percent confidence interval:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  -0.10399320 -0.08683188</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sample estimates:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mean of x </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.09541254 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="co"># View histogram, narrowed to small differences</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3.5</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">decDiff</span>,</span></span>
<span class="r-in"><span>    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">180</span>, <span class="fl">180</span>, <span class="fl">0.05</span><span class="op">)</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xlab <span class="op">=</span> <span class="st">"Declination difference [deg] from version=12 to version=13"</span>,</span></span>
<span class="r-in"><span>    main <span class="op">=</span> <span class="st">"Predictions for year 2020"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="magneticField-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html" class="external-link">quantile</a></span><span class="op">(</span><span class="va">decDiff</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.025</span>, <span class="fl">0.975</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       2.5%      97.5% </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -1.6695352  0.7159345 </span>
<span class="r-in"><span><span class="co"># Note that the large differences are at high latitudes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="imagep.html">imagep</a></span><span class="op">(</span><span class="va">lon</span>, <span class="va">lat</span>, <span class="va">decDiff</span>, zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">decDiff</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">coastlineWorld</span><span class="op">[[</span><span class="st">"longitude"</span><span class="op">]</span><span class="op">]</span>, <span class="va">coastlineWorld</span><span class="op">[[</span><span class="st">"latitude"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="magneticField-3.png" alt="" width="700" height="700"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer></div>





  </body></html>

