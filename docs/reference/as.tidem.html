<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create tidem Object From Fitted Harmonic Data — as.tidem • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create tidem Object From Fitted Harmonic Data — as.tidem"><meta name="description" content="This function takes a set of tidal constituent amplitudes
and phases, and constructs a return value of similar form
to that returned by tidem().  Its purpose is to enable
predictions based on published constituent amplitudes
and phases.  Since as.tidem() does not account for a
reference height, it is the user's responsible to account
for this after a prediction is made using predict.tidem()."><meta property="og:description" content="This function takes a set of tidal constituent amplitudes
and phases, and constructs a return value of similar form
to that returned by tidem().  Its purpose is to enable
predictions based on published constituent amplitudes
and phases.  Since as.tidem() does not account for a
reference height, it is the user's responsible to account
for this after a prediction is made using predict.tidem()."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create tidem Object From Fitted Harmonic Data</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/tides.R" class="external-link"><code>R/tides.R</code></a></small>
      <div class="d-none name"><code>as.tidem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function takes a set of tidal constituent amplitudes
and phases, and constructs a return value of similar form
to that returned by <code><a href="tidem.html">tidem()</a></code>.  Its purpose is to enable
predictions based on published constituent amplitudes
and phases.  Since <code>as.tidem()</code> does not account for a
reference height, it is the user's responsible to account
for this after a prediction is made using <code><a href="predict.tidem.html">predict.tidem()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">as.tidem</span><span class="op">(</span></span>
<span>  <span class="va">tRef</span>,</span>
<span>  <span class="va">latitude</span>,</span>
<span>  <span class="va">name</span>,</span>
<span>  <span class="va">amplitude</span>,</span>
<span>  <span class="va">phase</span>,</span>
<span>  <span class="va">frequency</span>,</span>
<span>  <span class="va">speed</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tref">tRef<a class="anchor" aria-label="anchor" href="#arg-tref"></a></dt>
<dd><p>a POSIXt value indicating the mean time of the
observations used to develop the harmonic model. This is rounded
to the nearest hour in <code>as.tidem()</code>, to match the behaviour
of <code><a href="tidem.html">tidem()</a></code>.</p></dd>


<dt id="arg-latitude">latitude<a class="anchor" aria-label="anchor" href="#arg-latitude"></a></dt>
<dd><p>numerical value indicating the latitude of the
observations that were used to create the harmonic model. This
is needed for nodal-correction procedures carried out
by <code><a href="tidemVuf.html">tidemVuf()</a></code>.</p></dd>


<dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>character vector holding names of constituents.</p></dd>


<dt id="arg-amplitude-phase">amplitude, phase<a class="anchor" aria-label="anchor" href="#arg-amplitude-phase"></a></dt>
<dd><p>numeric vectors of constituent amplitudes
and phases. These must be of the same length as <code>name</code>.</p></dd>


<dt id="arg-frequency-speed">frequency, speed<a class="anchor" aria-label="anchor" href="#arg-frequency-speed"></a></dt>
<dd><p>optional numeric vectors giving the frequencies
of the constituents (in cycles per hour) or the analogous speeds
(in degrees per hour).  Only one of these may be given, and a conversion
is done from the latter to the former, if required.  If the frequencies
are thus specified, then these are used instead of the frequencies that
oce normally used, as defined in <code>data(tideconst)</code>. A warning will
be issued if the absolute value of the relative frequency mismatch for any
given component exceeds 1e-6, and this will occur for any NOAA tables
containing the SA component, for which this relative mismatch
is approximately 4e-5 (see reference 5).</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of <a href="tidem-class.html">tidem</a>, with only minimal
contents.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>All the constituent names used by <code><a href="tidem.html">tidem()</a></code> are permitted here,
<em>except</em> for <code>"Z0"</code> (see “Description” regarding reference
height).
To get a list of constituent names, please consult Foreman (1978),
or type the following in an R console:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>name<span class="op">=</span><span class="va">tidedata</span><span class="op">$</span><span class="va">const</span><span class="op">$</span><span class="va">name</span>, freq<span class="op">=</span><span class="va">tidedata</span><span class="op">$</span><span class="va">const</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span></span></code></pre></div>

<p>In addition to the above, <code>as.tidem()</code> can handle NOAA names
of constituents.  For the most part, these match oce names, but
there are 4 exceptions: NOAA names
<code>"LAM2"</code>, <code>"M1"</code>, <code>"RHO"</code>, and <code>"2MK3"</code> are converted to oce names
<code>"LDA2"</code>, <code>"NO1"</code>, <code>"RHO1"</code>, and <code>"MO3"</code>. The name mapping was
inferred by matching frequencies; for these constituents, the
fractional mismatch in frequencies was under 4e-8;
see Reference 5 for more details.
A message is printed if these name conversions are required
in the particular use of <code>as.tidem()</code>.</p>
<p>Apart from the standard oce names and this set of NOAA synonyms,
any other constituent name is reported in a warning message.</p>
    </div>
    <div class="section level2">
    <h2 id="known-issues">Known issues<a class="anchor" aria-label="anchor" href="#known-issues"></a></h2>


<p>There are two known differences between <code><a href="tidem.html">tidem()</a></code> and the Matlab
<code>T_TIDE</code> package, as listed in references 3 and 4.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ol><li><p>Foreman, M. G. G., 1978. Manual for Tidal Currents Analysis and Prediction.
Pacific Marine Science Report. British Columbia, Canada: Institute of Ocean
Sciences, Patricia Bay.</p></li>
<li><p>Wikipedia, "Theory of Tides." https://en.wikipedia.org/wiki/Theory_of_tides
Downloaded Aug 17, 2019.</p></li>
<li><p>Github issue 1653 "tidem() and t_tide do not produce identical results"
(https://github.com/dankelley/oce/issues/1653)</p></li>
<li><p>Github issue 1654 "predict(tidem()) uses all constituents, unlike T_TIDE"
(https://github.com/dankelley/oce/issues/1654)</p></li>
<li><p>Github issue 2143 "mismatch in oce/NOAA frequency of SA tidal constituent"
(https://github.com/dankelley/oce/issues/2143)</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other things related to tides:
<code><a href="sub-sub-tidem-method.html">[[,tidem-method</a></code>,
<code>[[&lt;-,tidem-method</code>,
<code><a href="plot-tidem-method.html">plot,tidem-method</a></code>,
<code><a href="predict.tidem.html">predict.tidem</a>()</code>,
<code><a href="summary-tidem-method.html">summary,tidem-method</a></code>,
<code><a href="tidalCurrent.html">tidalCurrent</a></code>,
<code><a href="tidedata.html">tidedata</a></code>,
<code><a href="tidem.html">tidem</a></code>,
<code><a href="tidem-class.html">tidem-class</a></code>,
<code><a href="tidemAstron.html">tidemAstron</a>()</code>,
<code><a href="tidemVuf.html">tidemVuf</a>()</code>,
<code><a href="webtide.html">webtide</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: show agreement with tidem()</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># 'm0' is model fitted by tidem()</span></span></span>
<span class="r-in"><span><span class="va">m0</span> <span class="op">&lt;-</span> <span class="fu"><a href="tidem.html">tidem</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>tidal record too short to fit constituents: SA, SSA, MSM, MF, SIG1, RHO1, TAU1, BET1, CHI1, PI1, P1, S1, PSI1, PHI1, THE1, SO1, OQ2, 2N2, NU2, GAM2, H1, H2, MKS2, LDA2, T2, R2, K2, MSN2, SO3, MK4, SK4, 2MK6, MSK6</span>
<span class="r-in"><span><span class="va">p0</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m0</span>, <span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m1</span> <span class="op">&lt;-</span> <span class="fu">as.tidem</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, <span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"latitude"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="va">m0</span><span class="op">[[</span><span class="st">"name"</span><span class="op">]</span><span class="op">]</span>, <span class="va">m0</span><span class="op">[[</span><span class="st">"amplitude"</span><span class="op">]</span><span class="op">]</span>, <span class="va">m0</span><span class="op">[[</span><span class="st">"phase"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Test agreement with tidem() result, by comparing predicted sealevels.</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m1</span>, <span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">p1</span> <span class="op">-</span> <span class="va">p0</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1e-10</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: See the effect of dropping weak constituents</span></span></span>
<span class="r-in"><span><span class="va">m0</span><span class="op">[[</span><span class="st">"name"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">m0</span><span class="op">[[</span><span class="st">"amplitude"</span><span class="op">]</span><span class="op">]</span> <span class="op">&gt;</span> <span class="fl">0.05</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Z0"  "MM"  "MSF" "O1"  "K1"  "OO1" "N2"  "M2"  "S2" </span>
<span class="r-in"><span><span class="va">h</span> <span class="op">&lt;-</span> <span class="st">"</span></span></span>
<span class="r-in"><span><span class="st">name  amplitude      phase</span></span></span>
<span class="r-in"><span><span class="st">  Z0 1.98061875   0.000000</span></span></span>
<span class="r-in"><span><span class="st">  MM 0.21213065 263.344739</span></span></span>
<span class="r-in"><span><span class="st"> MSF 0.15605629 133.795004</span></span></span>
<span class="r-in"><span><span class="st">  O1 0.07641438  74.233130</span></span></span>
<span class="r-in"><span><span class="st">  K1 0.13473817  81.093134</span></span></span>
<span class="r-in"><span><span class="st"> OO1 0.05309911 235.749693</span></span></span>
<span class="r-in"><span><span class="st">  N2 0.08377108  44.521462</span></span></span>
<span class="r-in"><span><span class="st">  M2 0.49041340  77.703594</span></span></span>
<span class="r-in"><span><span class="st">  S2 0.22023705 137.475767"</span></span></span>
<span class="r-in"><span><span class="va">coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.table</a></span><span class="op">(</span>text <span class="op">=</span> <span class="va">h</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m2</span> <span class="op">&lt;-</span> <span class="fu">as.tidem</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"latitude"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    <span class="va">coef</span><span class="op">$</span><span class="va">name</span>, <span class="va">coef</span><span class="op">$</span><span class="va">amplitude</span>, <span class="va">coef</span><span class="op">$</span><span class="va">phase</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">m2</span>, <span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="oce.plot.ts.html">oce.plot.ts</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span>, <span class="va">p0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="co"># to match scales in other panels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="oce.plot.ts.html">oce.plot.ts</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span>, <span class="va">p1</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="oce.plot.ts.html">oce.plot.ts</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">[[</span><span class="st">"time"</span><span class="op">]</span><span class="op">]</span>, <span class="va">p2</span>, ylim <span class="op">=</span> <span class="va">ylim</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="as.tidem-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

