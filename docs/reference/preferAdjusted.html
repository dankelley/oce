<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Set Preference for Adjusted Values — preferAdjusted • oce</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Set Preference for Adjusted Values — preferAdjusted" />
<meta property="og:description" content="argo data can contain &quot;adjusted&quot; forms of data items,
which may be more trustworthy than the original
data, and preferAdjusted lets the user express a preference
for such adjusted data.  This means that using
[[,argo-method on the results returned by preferAdjusted
will (if possible) return adjusted data, and also use those adjusted
data in computations of derived quantities such as Absolute Salinity.
The preference applies also to units and to data-quality flags,
both of which can be returned by [[,argo-method, as
discussed in &amp;#8220;Details&amp;#8221;." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/oce.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dankelley/oce/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set Preference for Adjusted Values</h1>
    <small class="dont-index">Source: <a href='https://github.com/dankelley/oce/blob/master/R/argo.R'><code>R/argo.R</code></a></small>
    <div class="hidden name"><code>preferAdjusted.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><a href='argo-class.html'>argo</a> data can contain "adjusted" forms of data items,
which may be more trustworthy than the original
data, and <code>preferAdjusted</code> lets the user express a preference
for such adjusted data.  This means that using
<code><a href='[[,argo-method.html'>[[,argo-method</a></code> on the results returned by <code>preferAdjusted</code>
will (if possible) return adjusted data, and also use those adjusted
data in computations of derived quantities such as Absolute Salinity.
The preference applies also to units and to data-quality flags,
both of which can be returned by <code><a href='[[,argo-method.html'>[[,argo-method</a></code>, as
discussed in &#8220;Details&#8221;.</p>
    </div>

    <pre class="usage"><span class='fu'>preferAdjusted</span><span class='op'>(</span><span class='va'>argo</span>, which <span class='op'>=</span> <span class='st'>"all"</span>, fallback <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>argo</th>
      <td><p>An <a href='argo-class.html'>argo</a> object.</p></td>
    </tr>
    <tr>
      <th>which</th>
      <td><p>A character vector naming the items for which
(depending also on the value of <code>fallback</code>) adjusted values
are to be sought by future calls to <code><a href='[[,argo-method.html'>[[,argo-method</a></code>.
The short names are used, e.g. <code>which="oxygen"</code> means that
adjusted oxygen is to be returned in future calls
such as <code>argo[["oxygen"]]</code>.  The default,
<code>"all"</code>, means to  use adjusted values for any item in <code>argo</code>
that has adjusted values.</p></td>
    </tr>
    <tr>
      <th>fallback</th>
      <td><p>A logical value indicating whether to fall back
to unadjusted values for any data field in which the
adjusted values are all <code>NA</code>.  The default value, <code>TRUE</code>,
avoids a problem with biogeochemical fields, where adjustment
of any one field may lead to insertion of "adjusted" values for
other fields that consist of nothing more than <code>NA</code>s.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <a href='argo-class.html'>argo</a> object its <code>metadata</code> slot altered
(in its <code>adjustedWhich</code> and <code>adjustedFallback</code> elements)
as a signal for how <code><a href='[[,argo-method.html'>[[,argo-method</a></code> should
function on the object.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>preferAdjusted()</code> merely sets two items in the <code>metadata</code> slot of the
returned <a href='argo-class.html'>argo</a> object. The real action is carried out by
<code><a href='[[,argo-method.html'>[[,argo-method</a></code> but, for convenience, the details are explained here.</p>
<p>Consider salinity, for example.
If <code>which</code> equals <code>"all"</code>, or if it is a character
vector containing <code>"salinity"</code>, then using
<code><a href='[[,argo-method.html'>[[,argo-method</a></code> on the returned object
will yield the adjusted forms of the salinity data,
its associated flags, or its units.  Thus, in the salinity
case,</p><ul>
<li><p><code>argo[["salinity"]]</code> will attempt to return <code>argo@data$salinityAdjusted</code>
instead of returning <code>argo@data$salinity</code>, although if the adjusted values
are all <code>NA</code> then, depending on the value of <code>fallback</code>, the
unadjusted values may be returned; similarly</p></li>
<li><p><code>argo[["salinityFlags"]]</code> will attempt to return
<code>argo@metadata$flags$salinityAdjusted</code>
instead of <code>argo@metadata$flags$salinity</code>, and</p></li>
<li><p><code>argo[["salinityUnits"]]</code> will attempt to return
<code>argo@metadata$units$salinityAdjusted</code>
instead of <code>argo@metadata$units$salinity</code>.</p></li>
</ul>

<p>The default value, <code>which="all"</code>, indicates that this
preference for adjusted values will apply to all the
elements of the <code>data</code> slot of the returned object, along
with associated flags and units. This can be handy for quick
work, but analysts may also choose to restrict their use of
adjusted values to a subset of variables, based on their own
decisions about data quality or accuracy.</p>
<p>The default value <code>fallback=TRUE</code> indicates that later calls to
<code><a href='[[,argo-method.html'>[[,argo-method</a></code> should return unadjusted values for any
data items that have <code>NA</code> for all the adjusted values.  This
condition is rare for core variables (salinity, temperature and
pressure) but is annoyingly common for biogeochemical variables; see
e.g. Section 2.2.5 of Reference 1 for a discussion of
the conditions under which Argo netcdf files contain
adjusted values. Setting <code>fallback=FALSE</code> means that adjusted
values (if they exist) will always be returned, even if they
are a useless collection of <code>NA</code> values.</p>
<p>Error fields, such as <code>salinityAdjustedError</code>, are returned
as-is by <code><a href='[[,argo-method.html'>[[,argo-method</a></code>, regardless of whether
the object was created by <code>preferAdjusted</code>.</p>
<p>It should be noted that, regardless of whether <code>preferAdjusted</code>
has been used, the analyst can always access either unadjusted
or adjusted data directly, using the original variable names stored
in the source netcdf file.  For example, <code>argo[["PSAL"]]</code>
yields unadjusted salinity values, and
<code>argo[["PSAL_ADJUSTED"]]</code> yields adjusted values (if they exist, or
<code>NULL</code> if they do not).
Similarly, adjusted value can always be obtained by using a form
like <code>argo[["salinityAdjusted"]]</code>.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ol>
<li><p>Argo Data Management Team. "Argo User's Manual V3.3." Ifremer,
November 28, 2019.
doi: <a href='https://doi.org/10.13155/29825'>10.13155/29825</a></p></li>
</ol>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Dan Kelley, based on discussions with Jaimie Harbin (with
respect to the <code><a href='[[,argo-method.html'>[[,argo-method</a></code> interface) and Clark Richards
(with respect to storing the preference in the <code>metadata</code> slot).</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dankelley.github.io/oce/'>oce</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>argo</span><span class='op'>)</span>
<span class='va'>argoAdjusted</span> <span class='op'>&lt;-</span> <span class='fu'>preferAdjusted</span><span class='op'>(</span><span class='va'>argo</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>argo</span><span class='op'>[[</span><span class='st'>"salinityAdjusted"</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>argoAdjusted</span><span class='op'>[[</span><span class='st'>"salinity"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>argo</span><span class='op'>[[</span><span class='st'>"salinityFlagsAdjusted"</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>argoAdjusted</span><span class='op'>[[</span><span class='st'>"salinityFlags"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/all.equal.html'>all.equal</a></span><span class='op'>(</span><span class='va'>argo</span><span class='op'>[[</span><span class='st'>"salinityUnitsAdjusted"</span><span class='op'>]</span><span class='op'>]</span>, <span class='va'>argoAdjusted</span><span class='op'>[[</span><span class='st'>"salinityUnits"</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] TRUE</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


