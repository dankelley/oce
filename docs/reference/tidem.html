<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit a Tidal Model to a Timeseries — tidem • oce</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Tidal Model to a Timeseries — tidem"><meta property="og:description" content="The fit is done in terms of sine and cosine components at the indicated
tidal frequencies, with the amplitude and phase being calculated from the
resultant coefficients on the sine and cosine terms."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.6-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A_oce.html">1. Introduction to Oce</a>
    </li>
    <li>
      <a href="../articles/B_ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/D_map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/E_flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/F_subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dankelley/oce/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit a Tidal Model to a Timeseries</h1>
    <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/tides.R" class="external-link"><code>R/tides.R</code></a></small>
    <div class="hidden name"><code>tidem.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>The fit is done in terms of sine and cosine components at the indicated
tidal frequencies, with the amplitude and phase being calculated from the
resultant coefficients on the sine and cosine terms.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">tidem</span><span class="op">(</span>
  <span class="va">t</span>,
  <span class="va">x</span>,
  <span class="va">constituents</span>,
  infer <span class="op">=</span> <span class="cn">NULL</span>,
  latitude <span class="op">=</span> <span class="cn">NULL</span>,
  rc <span class="op">=</span> <span class="fl">1</span>,
  regress <span class="op">=</span> <span class="va">lm</span>,
  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>t</dt>
<dd><p>A <code>sealevel</code> object created with
<code><a href="read.sealevel.html">read.sealevel()</a></code> or <code><a href="as.sealevel.html">as.sealevel()</a></code>, or a vector of
times. In the former case, time is part of the object, so <code>t</code> may not
be given here.  In the latter case, <code>tidem</code> needs a way to determine
time, so <code>t</code> must be given.</p></dd>
<dt>x</dt>
<dd><p>an optional numerical vector holding something that varies with
time.  This is ignored if <code>t</code> is a <a href="sealevel-class.html">sealevel</a> object,
in which case it is inferred as <code>t[["elevation"]]</code>.</p></dd>
<dt>constituents</dt>
<dd><p>an optional character vector holding the names
of tidal constituents to which the fit is done (see “Details”
and “Constituent Naming Convention”.)</p></dd>
<dt>infer</dt>
<dd><p>a list of constituents to be inferred from
fitted constituents according to the method outlined
in Section 2.3.4 of Foreman (1978).
If <code>infer</code> is <code>NULL</code>, the default, then
no such inferences are made. Otherwise, some constituents
are computed based on other constituents, instead of being
determined by regression at the proper frequency.
If provided, <code>infer</code> must be a list containing
four elements:
<code>name</code>, a vector of strings naming the constituents to be
inferred; <code>from</code>, a vector of strings naming the fitted
constituents used as the sources for those inferences (these
source constituents are added to the regression list, if they
are not already there);
<code>amp</code>, a numerical vector of factors to be applied to the
source amplitudes; and <code>phase</code>, a numerical vector of angles,
in degrees, to be subtracted from the source phases. For example,
Following Foreman (1998), if any of the <code>name</code> items
have already been computed, then the suggested inference is ignored,
and the already-computed values are used.</p><div class="sourceCode"><pre><code>
infer=list(name=c("P1","K2"),
           from=c("K1", "S2"),
           amp=c(0.33093, 0.27215),
           phase=c(-7.07, -22.4)
</code></pre></div><p>means that the amplitude of <code>P1</code> will be set as 0.33093 times the calculated amplitude
of <code>K1</code>, and that the <code>P1</code> phase will be set to the <code>K1</code> phase,
minus an offset of <code>-7.07</code> degrees.
(This example is used in the Foreman (1978) discussion of a
Fortran analysis code and also in Pawlowicz et al. (2002) discussion
of the T_TIDE Matlab code.
Rounded to the 0.1mm resolution of values reported in Foreman (1978)
and Pawlowicz et al. (2002),
the <code>tidem</code> results have root-mean-square amplitude difference
to Foreman's (1978) Appendix 7.3 of 0.06mm; by comparison,
the results in Table 1 of Pawlowicz et al. (2002) agree with Foreman's
results to RMS difference 0.04mm.)</p></dd>
<dt>latitude</dt>
<dd><p>if provided, the latitude of the observations.  If not
provided, <code>tidem</code> will try to infer this from <code>sl</code>.</p></dd>
<dt>rc</dt>
<dd><p>the value of the coefficient in the Rayleigh criterion.</p></dd>
<dt>regress</dt>
<dd><p>function to be used for regression, by default
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, but could be for example <code>rlm</code> from the
<code>MASS</code> package.</p></dd>
<dt>debug</dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of <a href="tidem-class.html">tidem</a>, consisting of</p>
<dl><dt>const</dt>
<dd><p>constituent number, e.g. 1 for <code>Z0</code>, 1 for <code>SA</code>,
etc.</p></dd>
<dt>model</dt>
<dd><p>the regression model</p></dd>
<dt>name</dt>
<dd><p>a vector of constituent
names, in non-subscript format, e.g. "<code>M2</code>".</p></dd>
<dt>frequency</dt>
<dd><p>a vector
of constituent frequencies, in inverse hours.</p></dd>
<dt>amplitude</dt>
<dd><p>a vector of
fitted constituent amplitudes, in metres.</p></dd>
<dt>phase</dt>
<dd><p>a vector of fitted
constituent phase.  NOTE: The definition of phase is likely to change as
this function evolves.  For now, it is phase with respect to the first data
sample.</p></dd>
<dt>p</dt>
<dd><p>a vector containing a sort of p value for each
constituent.  This is calculated as the average of the p values for the
sine() and cosine() portions used in fitting; whether it makes any sense is
an open question.</p></dd>
</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The tidal constituents to be used in the analysis are specified as follows;
see “Constituent Naming Convention”.</p><ol><li><p>If <code>constituents</code> is not provided, then the constituent
list will be made up of the 69 constituents designated by Foreman as "standard".
These include astronomical frequencies and some shallow-water frequencies,
and are as follows: <code>c("Z0", "SA", "SSA", "MSM", "MM", "MSF", "MF", "ALP1", "2Q1", "SIG1", "Q1", "RHO1", "O1", "TAU1", "BET1", "NO1", "CHI1", "PI1", "P1", "S1", "K1", "PSI1", "PHI1", "THE1", "J1", "SO1", "OO1", "UPS1", "OQ2", "EPS2", "2N2", "MU2", "N2", "NU2", "GAM2", "H1", "M2", "H2", "MKS2", "LDA2", "L2", "T2", "S2", "R2", "K2", "MSN2", "ETA2", "MO3", "M3", "SO3", "MK3", "SK3", "MN4", "M4", "SN4", "MS4", "MK4", "S4", "SK4", "2MK5", "2SK5", "2MN6", "M6", "2MS6", "2MK6", "2SM6", "MSK6", "3MK7", "M8")</code>.</p></li>
<li><p>If the first item in <code>constituents</code> is the string
<code>"standard"</code>, then a provisional list is set up as in Case 1, and then
the (optional) rest of the elements of <code>constituents</code> are examined, in
order.  Each of these constituents is based on the name of a tidal
constituent in the Foreman (1978) notation.  (To get the list, execute
<code>data(tidedata)</code> and then execute <code>cat(tideData$name)</code>.)  Each
named constituent is added to the existing list, if it is not already there.
But, if the constituent is preceded by a minus sign, then it is removed
from the list (if it is already there).  Thus, for example,
<code>constituents=c("standard", "-M2", "ST32")</code> would remove the M2
constituent and add the ST32 constituent.</p></li>
<li><p>If the first item is not <code>"standard"</code>, then the list of
constituents is processed as in Case 2, but without starting with the
standard list. As an example, <code>constituents=c("K1", "M2")</code> would fit
for just the K1 and M2 components. (It would be strange to use a minus sign
to remove items from the list, but the function allows that.)</p></li>
</ol><p>In each of the above cases, the list is reordered in frequency prior to the
analysis, so that the results of <code><a href="summary-tidem-method.html">summary,tidem-method()</a></code> will be in a
familiar form.</p>
<p>Once the constituent list is determined, <code>tidem</code> prunes the elements of
the list by using the Rayleigh criterion, according to which two
constituents of frequencies \(f_1\) and \(f_2\) cannot be
resolved unless the time series spans a time interval of at least
\(rc/(f_1-f_2)\).</p>
<p>Finally, <code>tidem</code> looks in the remaining constituent list to check
that the application of the Rayleigh criterion has not removed any of the
constituents specified directly in the <code>constituents</code> argument. If
any are found to have been removed, then they are added back. This last
step was added on 2017-12-27, to make <code>tidem</code> behave the same
way as the Foreman (1978) code, as illustrated in his
Appendices 7.2 and 7.3. (As an aside, his Appendix 7.3 has some errors,
e.g. the frequency for the 2SK5 constituent is listed there (p58) as
0.20844743, but it is listed as 0.2084474129 in his Appendix 7.1 (p41).
For this reason, the frequency comparison is relaxed to a <code>tol</code>
value of <code>1e-7</code> in a portion of the oce test suite
(see <code>tests/testthat/test_tidem.R</code> in the source).</p>
<p>A specific example may be of help in understanding the removal of unresolvable
constituents. For example, the <code>data(sealevel)</code> dataset is of length
6718 hours, and this is too short to resolve the full list of constituents,
with the conventional (and, really, necessary) limit of <code>rc=1</code>.
From Table 1 of Foreman (1978), this timeseries is too short to resolve the
<code>SA</code> constituent, so that <code>SA</code> will not be in the resultant.
Similarly, Table 2 of Foreman (1978) dictates the removal of
<code>PI1</code>, <code>S1</code> and <code>PSI1</code> from the list. And, finally,
Table 3 of Foreman (1978) dictates the removal of
<code>H1</code>, <code>H2</code>, <code>T2</code> and <code>R2</code>, and since that document
suggests that <code>GAM2</code> be subsumed into <code>H1</code>,
then if <code>H1</code> is already being deleted, then
<code>GAM2</code> will also be deleted.</p>
<p>A summary of constituents may be found with:</p><div class="sourceCode"><pre><code><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">$</span><span class="va">const</span><span class="op">)</span></code></pre></div>

    </div>
    <div id="bugs">
    <h2>Bugs</h2>
    


<ol><li><p>This function is not fully developed yet, and both the
form of the call and the results of the calculation may change.</p></li>
<li><p>The reported <code>p</code> value may make no sense at all, and it might be
removed in a future version of this function. Perhaps a significance level
should be presented, as in the software developed by both Foreman and
Pawlowicz.</p></li>
</ol></div>
    <div id="constituent-naming-convention">
    <h2>Constituent Naming Convention</h2>
    


<p><code>tidem</code> uses constituent names that follow the convention
set by Foreman (1978). This convention is slightly different
from that used in the T-TIDE package of Pawlowicz et al.
(2002), with Foreman's <code>UPS1</code> and <code>M8</code> becoming
<code>UPSI</code> and <code>MS</code> in T-TIDE. To permit the use of either notation,
<code>tidem()</code> uses <code><a href="tidemConstituentNameFix.html">tidemConstituentNameFix()</a></code> to
convert from T-TIDE names to the
Foreman names, issuing warnings when doing so.</p>
    </div>
    <div id="agreement-with-t-tide-results">
    <h2>Agreement with <code>T_TIDE</code> results</h2>
    


<p>The <code>tidem</code> amplitude and phase results, obtained with</p><div class="sourceCode"><pre><code>
tidem(sealevelTuktoyaktuk, constituents=c("standard", "M10"),
     infer=list(name=c("P1", "K2"),
                from=c("K1", "S2"),
                amp=c(0.33093, 0.27215),
                phase=c(-7.07, -22.40))),
</code></pre></div><p>are identical the <code>T_TIDE</code> values listed in
Table 1 of Pawlowicz et al. (2002),
after rounding amplitude and phase to 4 and 2 digits past
the decimal place, to match the format of the table.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Foreman, M. G. G., 1978. Manual for Tidal Currents Analysis and Prediction.
Pacific Marine Science Report. British Columbia, Canada: Institute of Ocean
Sciences, Patricia Bay.</p>
<p>Foreman, M. G. G., Neufeld, E. T., 1991.  Harmonic tidal analyses of long
time series.  International Hydrographic Review, 68 (1), 95-108.</p>
<p>Leffler, K. E. and D. A. Jay, 2009.  Enhancing tidal harmonic analysis:
Robust (hybrid) solutions.  Continental Shelf Research, 29(1):78-88.</p>
<p>Pawlowicz, Rich, Bob Beardsley, and Steve Lentz, 2002.  Classical tidal
harmonic analysis including error estimates in MATLAB using <code>T_TIDE</code>.
Computers and Geosciences, 28, 929-937.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other things related to tides: 
<code><a href="sub-sub-tidem-method.html">[[,tidem-method</a></code>,
<code>[[&lt;-,tidem-method</code>,
<code><a href="as.tidem.html">as.tidem</a>()</code>,
<code><a href="plot-tidem-method.html">plot,tidem-method</a></code>,
<code><a href="predict.tidem.html">predict.tidem</a>()</code>,
<code><a href="summary-tidem-method.html">summary,tidem-method</a></code>,
<code><a href="tidalCurrent.html">tidalCurrent</a></code>,
<code><a href="tidedata.html">tidedata</a></code>,
<code><a href="tidem-class.html">tidem-class</a></code>,
<code><a href="tidemAstron.html">tidemAstron</a>()</code>,
<code><a href="tidemVuf.html">tidemVuf</a>()</code>,
<code><a href="webtide.html">webtide</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Dan Kelley</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># The demonstration time series from Foreman (1978),</span></span>
<span class="r-in"><span class="co"># also used in T_TIDE (Pawlowicz, 2002).</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">)</span></span>
<span class="r-in"><span class="va">tide</span> <span class="op">&lt;-</span> <span class="fu">tidem</span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note: the tidal record is too short to fit for constituents:  SA SSA MSM MF SIG1 RHO1 TAU1 BET1 CHI1 PI1 P1 S1 PSI1 PHI1 THE1 SO1 OQ2 2N2 NU2 GAM2 H1 H2 MKS2 LDA2 T2 R2 K2 MSN2 SO3 MK4 SK4 2MK6 MSK6 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tide</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem(t = sealevelTuktoyaktuk)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMS misfit to data:  0.7808454 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Freq Amplitude  Phase       p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z0   0.00000   1.98062   0.00 &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MM   0.00151   0.21213 263.34  0.0051 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSF  0.00282   0.15606 133.80  0.0062 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALP1 0.03440   0.01523 334.96  0.7368    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2Q1  0.03571   0.02458  82.69  0.6516    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q1   0.03722   0.01579  65.74  0.7541    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O1   0.03873   0.07641  74.23  0.1262    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NO1  0.04027   0.02903 238.14  0.3716    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K1   0.04178   0.13474  81.09  0.0262 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J1   0.04329   0.02530   7.32  0.5977    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OO1  0.04483   0.05310 235.75  0.2729    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> UPS1 0.04634   0.02980  91.73  0.6272    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EPS2 0.07618   0.02115 184.60  0.6769    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MU2  0.07769   0.04189  83.23  0.3727    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N2   0.07900   0.08377  44.52  0.0723 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2   0.08051   0.49041  77.70  0.3465    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L2   0.08202   0.02132  35.21  0.7301    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2   0.08333   0.22024 137.48 3.1e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ETA2 0.08507   0.00713 246.04  0.8902    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MO3  0.11924   0.01484 234.97  0.7426    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M3   0.12077   0.01226 261.57  0.8020    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MK3  0.12229   0.00492 331.60  0.9172    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SK3  0.12511   0.00234 237.67  0.9680    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MN4  0.15951   0.00917 256.47  0.8475    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M4   0.16102   0.01257 291.79  0.7544    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SN4  0.16233   0.00830 270.86  0.8659    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MS4  0.16384   0.00103 339.36  0.9842    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S4   0.16667   0.00468 299.56  0.9135    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MK5 0.20280   0.00127 310.16  0.9793    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2SK5 0.20845   0.00455 104.00  0.9172    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MN6 0.24002   0.00353 271.22  0.9371    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M6   0.24153   0.00173 158.87  0.9681    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MS6 0.24436   0.00564 306.12  0.8938    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2SM6 0.24718   0.00227 298.91  0.9555    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3MK7 0.28331   0.00857 212.25  0.8508    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M8   0.32205   0.00304  42.38  0.9497    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Processing Log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2022-02-18 15:25:30 UTC: `create 'tidem' object`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2022-02-18 15:25:30 UTC: `tidem(t = sealevelTuktoyaktuk)`</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># AIC analysis</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">tide</span><span class="op">[[</span><span class="st">"model"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]   71.0000 -606.0823</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># Fake data at M2</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tidedata"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">$</span><span class="va">const</span>, <span class="va">freq</span><span class="op">[</span><span class="va">name</span><span class="op">==</span><span class="st">"M2"</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">*</span><span class="fl">86400</span>, <span class="fl">3600</span><span class="op">)</span></span>
<span class="r-in"><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">M2</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">3600</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sl</span> <span class="op">&lt;-</span> <span class="fu"><a href="as.sealevel.html">as.sealevel</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span></span>
<span class="r-in"><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">tidem</span><span class="op">(</span><span class="va">sl</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Note: the tidal record is too short to fit for constituents:  SA SSA MSM MM MSF MF ALP1 2Q1 SIG1 Q1 RHO1 O1 TAU1 BET1 NO1 CHI1 PI1 P1 S1 PSI1 PHI1 THE1 J1 SO1 OO1 UPS1 OQ2 EPS2 2N2 MU2 N2 NU2 GAM2 H1 H2 MKS2 LDA2 L2 T2 S2 R2 K2 MSN2 ETA2 MO3 SO3 MK3 SK3 MN4 SN4 MS4 MK4 S4 SK4 2MN6 2MS6 2MK6 2SM6 MSK6 </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem(t = sl)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMS misfit to data:  4.033774e-15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Freq Amplitude Phase      p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z0   0.00e+00  1.68e-16   0.0   0.54    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K1   4.18e-02  5.21e-16 319.9   0.35    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2   8.05e-02  1.00e+00 266.4 &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M3   1.21e-01  1.69e-16  58.4   0.77    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M4   1.61e-01  5.52e-16 313.7   0.31    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MK5 2.03e-01  1.54e-16 187.5   0.83    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2SK5 2.08e-01  4.56e-16  80.2   0.55    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M6   2.42e-01  5.91e-16 194.0   0.42    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3MK7 2.83e-01  2.78e-16 248.8   0.65    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M8   3.22e-01  6.43e-16 134.0   0.24    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Processing Log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2022-02-18 15:25:30 UTC: `create 'tidem' object`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2022-02-18 15:25:30 UTC: `tidem(t = sl)`</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

