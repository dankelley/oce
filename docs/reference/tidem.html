<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit a Tidal Model to a Timeseries — tidem • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit a Tidal Model to a Timeseries — tidem"><meta name="description" content="The fit is done in terms of sine and cosine components at the indicated
tidal frequencies (after possibly pruning to satisfy the Rayleigh criterion,
as explained in phase 2 of the procedure outlined in
&amp;#8220;Details&amp;#8221;), with the amplitude and phase being
calculated from the resultant coefficients on the sine and cosine terms.
The scheme was devised for hourly data; for other sampling schemes,
see &amp;#8220;Application to non-hourly data&amp;#8221;."><meta property="og:description" content="The fit is done in terms of sine and cosine components at the indicated
tidal frequencies (after possibly pruning to satisfy the Rayleigh criterion,
as explained in phase 2 of the procedure outlined in
&amp;#8220;Details&amp;#8221;), with the amplitude and phase being
calculated from the resultant coefficients on the sine and cosine terms.
The scheme was devised for hourly data; for other sampling schemes,
see &amp;#8220;Application to non-hourly data&amp;#8221;."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit a Tidal Model to a Timeseries</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/tides.R" class="external-link"><code>R/tides.R</code></a></small>
      <div class="d-none name"><code>tidem.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The fit is done in terms of sine and cosine components at the indicated
tidal frequencies (after possibly pruning to satisfy the Rayleigh criterion,
as explained in phase 2 of the procedure outlined in
“Details”), with the amplitude and phase being
calculated from the resultant coefficients on the sine and cosine terms.
The scheme was devised for hourly data; for other sampling schemes,
see “Application to non-hourly data”.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tidem</span><span class="op">(</span></span>
<span>  <span class="va">t</span>,</span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">constituents</span>,</span>
<span>  infer <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  latitude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  regress <span class="op">=</span> <span class="va">lm</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>either a vector of times or a <a href="sealevel-class.html">sealevel</a> object
(as created with <code><a href="read.sealevel.html">read.sealevel()</a></code> or <code><a href="as.sealevel.html">as.sealevel()</a></code>).
In the first case, <code>x</code> must be provided.  In the second
case, though, any <code>x</code> that is provided will be ignored,
because sealevel objects contain both <code>time</code> and water
<code>elevation</code>, and the latter is used for <code>x</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>an optional numerical vector holding something that varies with
time.  This is ignored if <code>t</code> is a <a href="sealevel-class.html">sealevel</a> object,
because it is inferred automatically, using <code>t[["elevation"]]</code>.</p></dd>


<dt id="arg-constituents">constituents<a class="anchor" aria-label="anchor" href="#arg-constituents"></a></dt>
<dd><p>an optional character vector holding the names
of tidal constituents to which the fit is done; see “Details”
and “Constituent Naming Convention”.</p></dd>


<dt id="arg-infer">infer<a class="anchor" aria-label="anchor" href="#arg-infer"></a></dt>
<dd><p>a list of constituents to be inferred from
fitted constituents according to the method outlined
in Section 2.3.4 of Foreman (1978).
If <code>infer</code> is <code>NULL</code>, the default, then
no such inferences are made. Otherwise, some constituents
are computed based on other constituents, instead of being
determined by regression at the proper frequency.
If provided, <code>infer</code> must be a list containing
four elements:
<code>name</code>, a vector of strings naming the constituents to be
inferred; <code>from</code>, a vector of strings naming the fitted
constituents used as the sources for those inferences (these
source constituents are added to the regression list, if they
are not already there);
<code>amp</code>, a numerical vector of factors to be applied to the
source amplitudes; and <code>phase</code>, a numerical vector of angles,
in degrees, to be subtracted from the source phases. For example,
Following Foreman (1998), if any of the <code>name</code> items
have already been computed, then the suggested inference is ignored,
and the already-computed values are used.</p><div class="sourceCode"><pre><code>
infer=list(name=c("P1","K2"),
           from=c("K1", "S2"),
           amp=c(0.33093, 0.27215),
           phase=c(-7.07, -22.4)
</code></pre></div><p>means that the amplitude of <code>P1</code> will be set as 0.33093 times the calculated amplitude
of <code>K1</code>, and that the <code>P1</code> phase will be set to the <code>K1</code> phase,
minus an offset of <code>-7.07</code> degrees.
(This example is used in the Foreman (1978) discussion of a
Fortran analysis code and also in Pawlowicz et al. (2002) discussion
of the T_TIDE Matlab code.
Rounded to the 0.1mm resolution of values reported in Foreman (1978)
and Pawlowicz et al. (2002),
the <code>tidem</code> results have root-mean-square amplitude difference
to Foreman's (1978) Appendix 7.3 of 0.06mm; by comparison,
the results in Table 1 of Pawlowicz et al. (2002) agree with Foreman's
results to RMS difference 0.04mm.)</p></dd>


<dt id="arg-latitude">latitude<a class="anchor" aria-label="anchor" href="#arg-latitude"></a></dt>
<dd><p>if provided, the latitude of the observations.  If not
provided, <code>tidem</code> will try to infer this from the first argument,
if it is a <a href="sealevel-class.html">sealevel</a> object.</p></dd>


<dt id="arg-rc">rc<a class="anchor" aria-label="anchor" href="#arg-rc"></a></dt>
<dd><p>the value of the coefficient in the Rayleigh criterion.</p></dd>


<dt id="arg-regress">regress<a class="anchor" aria-label="anchor" href="#arg-regress"></a></dt>
<dd><p>function to be used for regression, by default
<code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>, but could be for example <code>rlm</code> from the
<code>MASS</code> package.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of <a href="tidem-class.html">tidem</a>, consisting of</p>
<dl><dt>const</dt>
<dd><p>constituent number, e.g. 1 for <code>Z0</code>, 1 for <code>SA</code>,
etc.</p></dd>
 <dt>model</dt>
<dd><p>the regression model</p></dd>
 <dt>name</dt>
<dd><p>a vector of constituent
names, in non-subscript format, e.g. "<code>M2</code>".</p></dd>
 <dt>frequency</dt>
<dd><p>a vector
of constituent frequencies, in inverse hours.</p></dd>
 <dt>amplitude</dt>
<dd><p>a vector of
fitted constituent amplitudes, in metres.</p></dd>
 <dt>phase</dt>
<dd><p>a vector of fitted
constituent phase.  NOTE: The definition of phase is likely to change as
this function evolves.  For now, it is phase with respect to the first data
sample.</p></dd>
 <dt>p</dt>
<dd><p>a vector containing a sort of p value for each
constituent.  This is calculated as the average of the p values for the
sine() and cosine() portions used in fitting; whether it makes any sense is
an open question.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>A summary of constituents used by <code>tidem()</code> may be found with:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">$</span><span class="va">const</span><span class="op">)</span></span></code></pre></div>

<p>A multi-stage procedure is used to establish the list of tidal
constituents to be used in the fit.</p>
<p><em>Phase 1: initial selection.</em></p>
<p>The initial list tidal constituents (prior to the pruning phase described
below) to be used in the analysis are specified as follows;
see “Constituent Naming Convention”.</p><ol><li><p>If <code>constituents</code> is not provided, then the constituent
list will be made up of the 69 constituents designated by Foreman as "standard".
These include astronomical frequencies and some shallow-water frequencies,
and are as follows: <code>c("Z0", "SA", "SSA", "MSM", "MM", "MSF", "MF", "ALP1", "2Q1", "SIG1", "Q1", "RHO1", "O1", "TAU1", "BET1", "NO1", "CHI1", "PI1", "P1", "S1", "K1", "PSI1", "PHI1", "THE1", "J1", "SO1", "OO1", "UPS1", "OQ2", "EPS2", "2N2", "MU2", "N2", "NU2", "GAM2", "H1", "M2", "H2", "MKS2", "LDA2", "L2", "T2", "S2", "R2", "K2", "MSN2", "ETA2", "MO3", "M3", "SO3", "MK3", "SK3", "MN4", "M4", "SN4", "MS4", "MK4", "S4", "SK4", "2MK5", "2SK5", "2MN6", "M6", "2MS6", "2MK6", "2SM6", "MSK6", "3MK7", "M8")</code>.</p></li>
<li><p>If the first item in <code>constituents</code> is the string
<code>"standard"</code>, then a provisional list is set up as in Case 1, and then
the (optional) rest of the elements of <code>constituents</code> are examined, in
order.  Each of these constituents is based on the name of a tidal
constituent in the Foreman (1978) notation.  (To get the list, execute
<code>data(tidedata)</code> and then execute <code>cat(tideData$name)</code>.)  Each
named constituent is added to the existing list, if it is not already there.
But, if the constituent is preceded by a minus sign, then it is removed
from the list (if it is already there).  Thus, for example, a user
might specify <code>constituents=c("standard", "-M2", "ST32")</code> to remove the M2
constituent and add the ST32 constituent.</p></li>
<li><p>If the first item is not <code>"standard"</code>, then the list of
constituents is processed as in Case 2, but without starting with the
standard list. As an example, <code>constituents=c("K1", "M2")</code> would fit
for just the K1 and M2 components. (It would be strange to use a minus sign
to remove items from the list, but the function allows that.)</p></li>
</ol><p>In each of the above cases, the list is reordered in frequency prior to the
analysis, so that the results of <code><a href="summary-tidem-method.html">summary,tidem-method()</a></code> will be in a
familiar form.</p>
<p><em>Phase 2: pruning based on Rayleigh's criterion.</em></p>
<p>Once the initial constituent list is determined during Phase 1,
<code>tidem</code> applies the Rayleigh criterion, which holds that
constituents of frequencies \(f_1\) and \(f_2\) cannot be
resolved unless the time series spans a time interval of at least
\(rc/(f_1-f_2)\).  The details of the decision of which
constituent to prune is fairly complicated, involving decisions
based on a comparison table.  The details of this process are provided
by Foreman (1978).</p>
<p><em>Phase 3: optionally overruling Rayleigh's criterion.</em></p>
<p>The pruning list from phase 2 can be overruled by the user. This
is done by retaining any constituents that the user has named
in the <code>constituents</code> parameter.  This action
was added on 2017-12-27, to make <code>tidem</code> behave the same
way as the Foreman (1978) code, as illustrated in his
Appendices 7.2 and 7.3. (As an aside, his Appendix 7.3 has some errors,
e.g. the frequency for the 2SK5 constituent is listed there (p58) as
0.20844743, but it is listed as 0.2084474129 in his Appendix 7.1 (p41).
For this reason, the frequency comparison is relaxed to a <code>tol</code>
value of <code>1e-7</code> in a portion of the oce test suite
(see <code>tests/testthat/test_tidem.R</code> in the source).</p>
<p><em>Comments on phases 2 and 3</em></p>
<p>A specific example may be of help in understanding the removal of unresolvable
constituents. For example, the <code>data(sealevel)</code> dataset is of length
6718 hours, and this is too short to resolve the full list of constituents,
with the conventional (and, really, necessary) limit of <code>rc=1</code>.
From Table 1 of Foreman (1978), this timeseries is too short to resolve the
<code>SA</code> constituent, so that <code>SA</code> will not be in the resultant.
Similarly, Table 2 of Foreman (1978) dictates the removal of
<code>PI1</code>, <code>S1</code> and <code>PSI1</code> from the list. And, finally,
Table 3 of Foreman (1978) dictates the removal of
<code>H1</code>, <code>H2</code>, <code>T2</code> and <code>R2</code>, and since that document
suggests that <code>GAM2</code> be subsumed into <code>H1</code>,
then if <code>H1</code> is already being deleted, then
<code>GAM2</code> will also be deleted.</p>
    </div>
    <div class="section level2">
    <h2 id="application-to-non-hourly-data">Application to non-hourly data<a class="anchor" aria-label="anchor" href="#application-to-non-hourly-data"></a></h2>



<p>The framework on which <code>tidem()</code> rests on the assumption of data
that have been sampled on a 1-hour interval (see e.g. Foreman, 1977).
Since regression (as opposed to spectral analysis) is used to infer
the amplitude and phase of tidal constituents, data gaps do not pose
a serious problem. Sampling intervals under an hour are also not a
problem. However, trying to use <code>tidem()</code> on time series that are
sampled at uniform intervals that exceed 1 hour can lead to results
that are difficult to interpret.  For example, some drifter data are
sampled at a 6-hour interval.  This makes it impossible to fit for the
S4 component (which has exactly 6 cycles per day), because the method
works by constructing sine and cosine series at tidal frequencies and
using these as the basis for regression.  Each of these series will have
a constant value through the constructed time, and regression cannot handle
that (in addition to a constant-value constructed series that is used to fit
for the Z0 constituent).  <code>tidem()</code> tries to handle such problems by examining
the range of the constructed sine and cosine time-series, omitting any
constituents that yield near-constant values in either of these. Messages are
issued if this problem is encountered.  This prevents failure of the regression,
and the predictions of the regression seem to represent the data reasonably well,
but the inferred constituent amplitudes are not physically reasonable. Cautious
use of <code>tidem()</code> to infer individual constituents might be warranted, but
users must be aware that the results will be difficult to interpret. The tool
is simply not designed for this use.</p>
    </div>
    <div class="section level2">
    <h2 id="bugs">Bugs<a class="anchor" aria-label="anchor" href="#bugs"></a></h2>



<ol><li><p>This function is not fully developed yet, and both the
form of the call and the results of the calculation may change.</p></li>
<li><p>The reported <code>p</code> value may make no sense at all, and it might be
removed in a future version of this function. Perhaps a significance level
should be presented, as in the software developed by both Foreman and
Pawlowicz.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="constituent-naming-convention">Constituent Naming Convention<a class="anchor" aria-label="anchor" href="#constituent-naming-convention"></a></h2>



<p><code>tidem</code> uses constituent names that follow the convention
set by Foreman (1978). This convention is slightly different
from that used in the T-TIDE package of Pawlowicz et al.
(2002), with Foreman's <code>UPS1</code> and <code>M8</code> becoming
<code>UPSI</code> and <code>MS</code> in T-TIDE. To permit the use of either notation,
<code>tidem()</code> uses <code><a href="tidemConstituentNameFix.html">tidemConstituentNameFix()</a></code> to
convert from T-TIDE names to the
Foreman names, issuing warnings when doing so.</p>
    </div>
    <div class="section level2">
    <h2 id="agreement-with-t-tide-results">Agreement with <code>T_TIDE</code> results<a class="anchor" aria-label="anchor" href="#agreement-with-t-tide-results"></a></h2>



<p>The <code>tidem</code> amplitude and phase results, obtained with</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/tidem.html">tidem</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span>, constituents<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"standard"</span>, <span class="st">"M10"</span><span class="op">)</span>,</span>
<span>    infer<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"P1"</span>, <span class="st">"K2"</span><span class="op">)</span>,</span>
<span>        from<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"K1"</span>, <span class="st">"S2"</span><span class="op">)</span>,</span>
<span>        amp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.33093</span>, <span class="fl">0.27215</span><span class="op">)</span>,</span>
<span>        phase<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">7.07</span>, <span class="op">-</span><span class="fl">22.40</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div><p>match the <code>T_TIDE</code> values listed in
Table 1 of Pawlowicz et al. (2002),
after rounding amplitude and phase to 4 and 2 digits past
the decimal place, respectively, to match the format of
that table.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Foreman, M G., 1977 (revised 1996).
Manual for Tidal Heights Analysis and Prediction.
Pacific Marine Science Report 77-10.
British Columbia, Canada: Institute of Ocean Sciences, Patricia Bay.</p>
<p>Foreman, M. G. G., 1978.
Manual for Tidal Currents Analysis and Prediction.
Pacific Marine Science Report 78-6.
British Columbia, Canada: Institute of Ocean Sciences, Patricia Bay,</p>
<p>Foreman, M. G. G., Neufeld, E. T., 1991.
Harmonic tidal analyses of long time series.
International Hydrographic Review, 68 (1), 95-108.</p>
<p>Leffler, K. E. and D. A. Jay, 2009.  Enhancing tidal harmonic analysis:
Robust (hybrid) solutions.  Continental Shelf Research, 29(1):78-88.</p>
<p>Pawlowicz, Rich, Bob Beardsley, and Steve Lentz, 2002.  Classical tidal
harmonic analysis including error estimates in MATLAB using <code>T_TIDE</code>.
Computers and Geosciences, 28, 929-937.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other things related to tides:
<code><a href="sub-sub-tidem-method.html">[[,tidem-method</a></code>,
<code>[[&lt;-,tidem-method</code>,
<code><a href="as.tidem.html">as.tidem</a>()</code>,
<code><a href="plot-tidem-method.html">plot,tidem-method</a></code>,
<code><a href="predict.tidem.html">predict.tidem</a>()</code>,
<code><a href="summary-tidem-method.html">summary,tidem-method</a></code>,
<code><a href="tidalCurrent.html">tidalCurrent</a></code>,
<code><a href="tidedata.html">tidedata</a></code>,
<code><a href="tidem-class.html">tidem-class</a></code>,
<code><a href="tidemAstron.html">tidemAstron</a>()</code>,
<code><a href="tidemVuf.html">tidemVuf</a>()</code>,
<code><a href="webtide.html">webtide</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># The demonstration time series from Foreman (1978),</span></span></span>
<span class="r-in"><span><span class="co"># also used in T_TIDE (Pawlowicz, 2002).</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">tide</span> <span class="op">&lt;-</span> <span class="fu">tidem</span><span class="op">(</span><span class="va">sealevelTuktoyaktuk</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: the tidal record is too short to fit for constituents: SA, SSA, MSM, MF, SIG1, RHO1, TAU1, BET1, CHI1, PI1, P1, S1, PSI1, PHI1, THE1, SO1, OQ2, 2N2, NU2, GAM2, H1, H2, MKS2, LDA2, T2, R2, K2, MSN2, SO3, MK4, SK4, 2MK6, MSK6</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">tide</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem(t = sealevelTuktoyaktuk)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMS misfit to data:  0.7808454 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Freq Amplitude  Phase       p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z0   0.00000   1.98062   0.00 &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MM   0.00151   0.21213 263.34  0.0051 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSF  0.00282   0.15606 133.80  0.0062 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ALP1 0.03440   0.01523 334.96  0.7368    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2Q1  0.03571   0.02458  82.69  0.6516    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Q1   0.03722   0.01579  65.74  0.7541    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> O1   0.03873   0.07641  74.23  0.1262    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> NO1  0.04027   0.02903 238.14  0.3716    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K1   0.04178   0.13474  81.09  0.0262 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> J1   0.04329   0.02530   7.32  0.5977    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> OO1  0.04483   0.05310 235.75  0.2729    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> UPS1 0.04634   0.02980  91.73  0.6272    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EPS2 0.07618   0.02115 184.60  0.6769    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MU2  0.07769   0.04189  83.23  0.3727    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> N2   0.07900   0.08377  44.52  0.0723 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2   0.08051   0.49041  77.70  0.3465    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> L2   0.08202   0.02132  35.21  0.7301    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S2   0.08333   0.22024 137.48 3.1e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ETA2 0.08507   0.00713 246.04  0.8902    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MO3  0.11924   0.01484 234.97  0.7426    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M3   0.12077   0.01226 261.57  0.8020    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MK3  0.12229   0.00492 331.60  0.9172    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SK3  0.12511   0.00234 237.67  0.9680    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MN4  0.15951   0.00917 256.47  0.8475    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M4   0.16102   0.01257 291.79  0.7544    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SN4  0.16233   0.00830 270.86  0.8659    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MS4  0.16384   0.00103 339.36  0.9842    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> S4   0.16667   0.00468 299.56  0.9135    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MK5 0.20280   0.00127 310.16  0.9793    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2SK5 0.20845   0.00455 104.00  0.9172    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MN6 0.24002   0.00353 271.22  0.9371    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M6   0.24153   0.00173 158.87  0.9681    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MS6 0.24436   0.00564 306.12  0.8938    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2SM6 0.24718   0.00227 298.91  0.9555    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3MK7 0.28331   0.00857 212.25  0.8508    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M8   0.32205   0.00304  42.38  0.9497    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Processing Log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2024-12-07 18:25:01 UTC: `create 'tidem' object`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2024-12-07 18:25:01 UTC: `tidem(t = sealevelTuktoyaktuk)`</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># AIC analysis</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/extractAIC.html" class="external-link">extractAIC</a></span><span class="op">(</span><span class="va">tide</span><span class="op">[[</span><span class="st">"model"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]   71.0000 -606.0823</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fake data at M2</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"tidedata"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">M2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">tidedata</span><span class="op">$</span><span class="va">const</span>, <span class="va">freq</span><span class="op">[</span><span class="va">name</span> <span class="op">==</span> <span class="st">"M2"</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span> <span class="op">*</span> <span class="fl">86400</span>, <span class="fl">3600</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">M2</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">3600</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sl</span> <span class="op">&lt;-</span> <span class="fu"><a href="as.sealevel.html">as.sealevel</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">m</span> <span class="op">&lt;-</span> <span class="fu">tidem</span><span class="op">(</span><span class="va">sl</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Note: the tidal record is too short to fit for constituents: SA, SSA, MSM, MM, MSF, MF, ALP1, 2Q1, SIG1, Q1, RHO1, O1, TAU1, BET1, NO1, CHI1, PI1, P1, S1, PSI1, PHI1, THE1, J1, SO1, OO1, UPS1, OQ2, EPS2, 2N2, MU2, N2, NU2, GAM2, H1, H2, MKS2, LDA2, L2, T2, S2, R2, K2, MSN2, ETA2, MO3, SO3, MK3, SK3, MN4, SN4, MS4, MK4, S4, SK4, 2MN6, 2MS6, 2MK6, 2SM6, MSK6</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> tidem(t = sl)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMS misfit to data:  4.085402e-15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted Model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Freq Amplitude Phase      p    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Z0   0.00e+00  1.05e-16   0.0   0.70    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> K1   4.18e-02  5.23e-16 322.1   0.35    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M2   8.05e-02  1.00e+00 266.4 &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M3   1.21e-01  1.36e-16  70.9   0.84    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M4   1.61e-01  5.46e-16 308.7   0.33    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2MK5 2.03e-01  1.59e-16 209.7   0.79    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2SK5 2.08e-01  4.90e-16  74.4   0.49    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M6   2.42e-01  5.79e-16 191.5   0.45    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3MK7 2.83e-01  2.39e-16 232.2   0.67    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> M8   3.22e-01  5.93e-16 139.9   0.28    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Processing Log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2024-12-07 18:25:01 UTC: `create 'tidem' object`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     - 2024-12-07 18:25:01 UTC: `tidem(t = sl)`</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

