<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Squared buoyancy frequency for seawater — swN2 • oce</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Squared buoyancy frequency for seawater — swN2" />
<meta property="og:description" content="Compute \(N^2\), the square of the buoyancy frequency for a seawater
profile." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/oce.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dankelley/oce/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Squared buoyancy frequency for seawater</h1>
    <small class="dont-index">Source: <a href='https://github.com/dankelley/oce/blob/master/R/sw.R'><code>R/sw.R</code></a></small>
    <div class="hidden name"><code>swN2.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute \(N^2\), the square of the buoyancy frequency for a seawater
profile.</p>
    </div>

    <pre class="usage"><span class='fu'>swN2</span>(
  <span class='no'>pressure</span>,
  <span class='kw'>sigmaTheta</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='no'>derivs</span>,
  <span class='no'>df</span>,
  <span class='kw'>debug</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/options.html'>getOption</a></span>(<span class='st'>"oceDebug"</span>),
  <span class='no'>...</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>pressure</th>
      <td><p>either pressure (dbar) (in which case <code>sigmaTheta</code> must
be provided) <em>or</em> an object of class <code>ctd</code> object (in which case
<code>sigmaTheta</code> is inferred from the object.</p></td>
    </tr>
    <tr>
      <th>sigmaTheta</th>
      <td><p>Surface-referenced potential density minus 1000
(kg/m\(^3\)).</p></td>
    </tr>
    <tr>
      <th>derivs</th>
      <td><p>optional argument to control how the derivative
\(d\sigma_\theta/dp\) is calculated.  This may
be a character string or a function of two arguments.  See &#8220;Details&#8221;.</p></td>
    </tr>
    <tr>
      <th>df</th>
      <td><p>argument passed to <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline()</a></code> if this function is
used for smoothing; set to <code>NA</code> to prevent smoothing.</p></td>
    </tr>
    <tr>
      <th>debug</th>
      <td><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>additional argument, passed to <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline()</a></code>, in
the case that <code>derivs="smoothing"</code>.  See &#8220;Details&#8221;.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Square of buoyancy frequency (\(radian^2/s^2\)).</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Smoothing is often useful prior to computing buoyancy frequency, and so this
may optionally be done with <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline()</a></code>, unless
<code>df=NA</code>, in which case raw data are used.  If <code>df</code> is not
provided, a possibly reasonable value computed from an analysis of the
profile, based on the number of pressure levels.</p>
<p>The core of the
method involves differentiating potential density (referenced to median
pressure) with respect to pressure, and the <code>derivs</code> argument is used
to control how this is done, as follows.</p><ul>
<li><p>If <code>derivs</code> is not supplied, the action is as though it were
given as the string <code>"smoothing"</code></p></li>
<li><p>If <code>derivs</code> equals <code>"simple"</code>, then the derivative of
density with respect to pressure is calculated as the ratio of first-order
derivatives of density and pressure, each calculated using
<code><a href='https://rdrr.io/r/base/diff.html'>diff()</a></code>.  (A zero is appended at the top level.)</p></li>
<li><p>If <code>derivs</code> equals <code>"smoothing"</code>, then the processing
depends on the number of data in the profile, and on whether <code>df</code> is
given as an optional argument.  When the number of points exceeds 4, and
when <code>df</code> exceeds 1, <code><a href='https://rdrr.io/r/stats/smooth.spline.html'>smooth.spline()</a></code> is used to calculate
smoothing spline representation the variation of density as a function of
pressure, and derivatives are extracted from the spline using
<code>predict</code>.  Otherwise, density is smoothed using <code><a href='https://rdrr.io/r/stats/smooth.html'>smooth()</a></code>,
and derivatives are calculated as with the <code>"simple"</code> method.</p></li>
<li><p>If <code>derivs</code> is a function taking two arguments (first pressure,
then density) then that function is called directly to calculate the
derivative, and no smoothing is done before or after that call.</p></li>
</ul>

<p>For precise work, it makes sense to skip <code>swN2</code> entirely, choosing
whether, what, and how to smooth based on an understanding of fundamental
principles as well as data practicalities.</p>
    <h2 class="hasAnchor" id="deprecation-notice"><a class="anchor" href="#deprecation-notice"></a>Deprecation Notice</h2>

    

<p>Until 2019 April 11, <code>swN2</code> had an argument named <code>eos</code>. However,
this did not work as stated, unless the first argument was a <code>ctd</code>
object. Besides, the argument name was inherently deceptive, because the UNESCO
scheme does not specify how N2 is to be calculated.
Nothing is really lost by making this change, because the new default is the
same as was previously available with the <code>eos="unesco"</code>
setup, and the gsw-formulated estimate of N2 is provided
by <code><a href='https://rdrr.io/pkg/gsw/man/gsw_Nsquared.html'>gsw::gsw_Nsquared()</a></code> in the <a href='https://CRAN.R-project.org/package=gsw'><span class="pkg">gsw</span></a> package.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>The <code><a href='https://rdrr.io/pkg/gsw/man/gsw_Nsquared.html'>gsw::gsw_Nsquared()</a></code> function of the <a href='https://CRAN.R-project.org/package=gsw'><span class="pkg">gsw</span></a>
provides an alternative to this, as formulated in the GSW system. It
has a more sophisticated treatment of potential density, but it is based
on simple first-difference derivatives, so its results may require
smoothing, depending on the dataset and purpose of the analysis.</p>
<p>Other functions that calculate seawater properties: 
<code><a href='T68fromT90.html'>T68fromT90</a>()</code>,
<code><a href='T90fromT48.html'>T90fromT48</a>()</code>,
<code><a href='T90fromT68.html'>T90fromT68</a>()</code>,
<code><a href='swAbsoluteSalinity.html'>swAbsoluteSalinity</a>()</code>,
<code><a href='swAlphaOverBeta.html'>swAlphaOverBeta</a>()</code>,
<code><a href='swAlpha.html'>swAlpha</a>()</code>,
<code><a href='swBeta.html'>swBeta</a>()</code>,
<code><a href='swCSTp.html'>swCSTp</a>()</code>,
<code><a href='swConservativeTemperature.html'>swConservativeTemperature</a>()</code>,
<code><a href='swDepth.html'>swDepth</a>()</code>,
<code><a href='swDynamicHeight.html'>swDynamicHeight</a>()</code>,
<code><a href='swLapseRate.html'>swLapseRate</a>()</code>,
<code><a href='swPressure.html'>swPressure</a>()</code>,
<code><a href='swRho.html'>swRho</a>()</code>,
<code><a href='swRrho.html'>swRrho</a>()</code>,
<code><a href='swSCTp.html'>swSCTp</a>()</code>,
<code><a href='swSTrho.html'>swSTrho</a>()</code>,
<code><a href='swSigma0.html'>swSigma0</a>()</code>,
<code><a href='swSigma1.html'>swSigma1</a>()</code>,
<code><a href='swSigma2.html'>swSigma2</a>()</code>,
<code><a href='swSigma3.html'>swSigma3</a>()</code>,
<code><a href='swSigma4.html'>swSigma4</a>()</code>,
<code><a href='swSigmaTheta.html'>swSigmaTheta</a>()</code>,
<code><a href='swSigmaT.html'>swSigmaT</a>()</code>,
<code><a href='swSigma.html'>swSigma</a>()</code>,
<code><a href='swSoundAbsorption.html'>swSoundAbsorption</a>()</code>,
<code><a href='swSoundSpeed.html'>swSoundSpeed</a>()</code>,
<code><a href='swSpecificHeat.html'>swSpecificHeat</a>()</code>,
<code><a href='swSpice.html'>swSpice</a>()</code>,
<code><a href='swTFreeze.html'>swTFreeze</a>()</code>,
<code><a href='swTSrho.html'>swTSrho</a>()</code>,
<code><a href='swThermalConductivity.html'>swThermalConductivity</a>()</code>,
<code><a href='swTheta.html'>swTheta</a>()</code>,
<code><a href='swViscosity.html'>swViscosity</a>()</code>,
<code><a href='swZ.html'>swZ</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>oce</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>ctd</span>)
<span class='co'># Left panel: density</span>
<span class='no'>p</span> <span class='kw'>&lt;-</span> <span class='no'>ctd</span><span class='kw'>[[</span><span class='st'>"pressure"</span>]]
<span class='no'>ylim</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/rev.html'>rev</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/range.html'>range</a></span>(<span class='no'>p</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/par.html'>par</a></span>(<span class='kw'>mfrow</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>1</span>, <span class='fl'>2</span>), <span class='kw'>mar</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>3</span>, <span class='fl'>3</span>, <span class='fl'>1</span>, <span class='fl'>1</span>), <span class='kw'>mgp</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>0.7</span>, <span class='fl'>0</span>))
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>ctd</span><span class='kw'>[[</span><span class='st'>"sigmaTheta"</span>]], <span class='no'>p</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='no'>ylim</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>'l'</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/expression.html'>expression</a></span>(<span class='no'>sigma</span>[<span class='no'>theta</span>]))
<span class='co'># Right panel: N2, with default settings (black) and with df=2 (red)</span>
<span class='no'>N2</span> <span class='kw'>&lt;-</span> <span class='fu'>swN2</span>(<span class='no'>ctd</span>)
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>N2</span>, <span class='no'>p</span>, <span class='kw'>ylim</span><span class='kw'>=</span><span class='no'>ylim</span>, <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"N2 [1/s^2]"</span>, <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"p"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='fu'>swN2</span>(<span class='no'>ctd</span>, <span class='kw'>df</span><span class='kw'>=</span><span class='fl'>3</span>), <span class='no'>p</span>, <span class='kw'>col</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='img'><img src='swN2-1.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


