<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Squared Buoyancy Frequency for Seawater — swN2 • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Squared Buoyancy Frequency for Seawater — swN2"><meta name="description" content="Compute \(N^2\), the square of the buoyancy frequency for a seawater
profile."><meta property="og:description" content="Compute \(N^2\), the square of the buoyancy frequency for a seawater
profile."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Squared Buoyancy Frequency for Seawater</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/sw.R" class="external-link"><code>R/sw.R</code></a></small>
      <div class="d-none name"><code>swN2.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute \(N^2\), the square of the buoyancy frequency for a seawater
profile.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">swN2</span><span class="op">(</span></span>
<span>  <span class="va">pressure</span>,</span>
<span>  sigmaTheta <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">derivs</span>,</span>
<span>  <span class="va">df</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pressure">pressure<a class="anchor" aria-label="anchor" href="#arg-pressure"></a></dt>
<dd><p>either pressure (dbar) (in which case <code>sigmaTheta</code> must
be provided) <em>or</em> an object of class <code>ctd</code> object (in which case
<code>sigmaTheta</code> is inferred from the object.</p></dd>


<dt id="arg-sigmatheta">sigmaTheta<a class="anchor" aria-label="anchor" href="#arg-sigmatheta"></a></dt>
<dd><p>Surface-referenced potential density minus 1000
(kg/m\(^3\)).</p></dd>


<dt id="arg-derivs">derivs<a class="anchor" aria-label="anchor" href="#arg-derivs"></a></dt>
<dd><p>optional argument to control how the derivative
\(d\sigma_\theta/dp\) is calculated.  This may
be a character string or a function of two arguments.  See “Details”.</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>argument passed to <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline()</a></code> if this function is
used for smoothing; set to <code>NA</code> to prevent smoothing.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional argument, passed to <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline()</a></code>, in
the case that <code>derivs="smoothing"</code>.  See “Details”.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Square of buoyancy frequency (\(radian^2/s^2\)).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Smoothing is often useful prior to computing buoyancy frequency, and so this
may optionally be done with <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline()</a></code>, unless
<code>df=NA</code>, in which case raw data are used.  If <code>df</code> is not
provided, a possibly reasonable value computed from an analysis of the
profile, based on the number of pressure levels.</p>
<p>The core of the method involves computing potential density referenced to median
pressure, using the UNESCO-style <a href="swSigmaTheta.html">swSigmaTheta</a> function, and then differentiating
this with respect to pressure. The <code>derivs</code> argument is used
to control how this is done, as follows.</p><ul><li><p>If <code>derivs</code> is not supplied, the action is as though it were
given as the string <code>"smoothing"</code></p></li>
<li><p>If <code>derivs</code> equals <code>"simple"</code>, then the derivative of
density with respect to pressure is calculated as the ratio of first-order
derivatives of density and pressure, each calculated using
<code><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff()</a></code>.  (A zero is appended at the top level.)</p></li>
<li><p>If <code>derivs</code> equals <code>"smoothing"</code>, then the processing
depends on the number of data in the profile, and on whether <code>df</code> is
given as an optional argument.  When the number of points exceeds 4, and
when <code>df</code> exceeds 1, <code><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline()</a></code> is used to calculate
smoothing spline representation the variation of density as a function of
pressure, and derivatives are extracted from the spline using
<code>predict</code>.  Otherwise, density is smoothed using <code><a href="https://rdrr.io/r/stats/smooth.html" class="external-link">smooth()</a></code>,
and derivatives are calculated as with the <code>"simple"</code> method.</p></li>
<li><p>If <code>derivs</code> is a function taking two arguments (first pressure,
then density) then that function is called directly to calculate the
derivative, and no smoothing is done before or after that call.</p></li>
</ul><p>For precise work, it makes sense to skip <code>swN2</code> entirely, choosing
whether, what, and how to smooth based on an understanding of fundamental
principles as well as data practicalities.</p>
    </div>
    <div class="section level2">
    <h2 id="deprecation-notice">Deprecation Notice<a class="anchor" aria-label="anchor" href="#deprecation-notice"></a></h2>


<p>Until 2019 April 11, <code>swN2</code> had an argument named <code>eos</code>. However,
this did not work as stated, unless the first argument was a <code>ctd</code>
object. Besides, the argument name was inherently deceptive, because the UNESCO
scheme does not specify how N2 is to be calculated.
Nothing is really lost by making this change, because the new default is the
same as was previously available with the <code>eos="unesco"</code>
setup, and the gsw-formulated estimate of N2 is provided
by <code><a href="http://teos-10.github.io/GSW-R/reference/gsw_Nsquared.html" class="external-link">gsw::gsw_Nsquared()</a></code> in the <a href="https://CRAN.R-project.org/package=gsw" class="external-link"><span class="pkg">gsw</span></a> package.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The <code><a href="http://teos-10.github.io/GSW-R/reference/gsw_Nsquared.html" class="external-link">gsw::gsw_Nsquared()</a></code> function of the <a href="https://CRAN.R-project.org/package=gsw" class="external-link"><span class="pkg">gsw</span></a>
provides an alternative to this, as formulated in the GSW system. It
has a more sophisticated treatment of potential density, but it is based
on simple first-difference derivatives, so its results may require
smoothing, depending on the dataset and purpose of the analysis.</p>
<p>Other functions that calculate seawater properties:
<code><a href="T68fromT90.html">T68fromT90</a>()</code>,
<code><a href="T90fromT48.html">T90fromT48</a>()</code>,
<code><a href="T90fromT68.html">T90fromT68</a>()</code>,
<code><a href="computableWaterProperties.html">computableWaterProperties</a>()</code>,
<code><a href="locationForGsw.html">locationForGsw</a>()</code>,
<code><a href="swAbsoluteSalinity.html">swAbsoluteSalinity</a>()</code>,
<code><a href="swAlpha.html">swAlpha</a>()</code>,
<code><a href="swAlphaOverBeta.html">swAlphaOverBeta</a>()</code>,
<code><a href="swBeta.html">swBeta</a>()</code>,
<code><a href="swCSTp.html">swCSTp</a>()</code>,
<code><a href="swConservativeTemperature.html">swConservativeTemperature</a>()</code>,
<code><a href="swDepth.html">swDepth</a>()</code>,
<code><a href="swDynamicHeight.html">swDynamicHeight</a>()</code>,
<code><a href="swLapseRate.html">swLapseRate</a>()</code>,
<code><a href="swPressure.html">swPressure</a>()</code>,
<code><a href="swRho.html">swRho</a>()</code>,
<code><a href="swRrho.html">swRrho</a>()</code>,
<code><a href="swSCTp.html">swSCTp</a>()</code>,
<code><a href="swSR.html">swSR</a>()</code>,
<code><a href="swSTrho.html">swSTrho</a>()</code>,
<code><a href="swSigma.html">swSigma</a>()</code>,
<code><a href="swSigma0.html">swSigma0</a>()</code>,
<code><a href="swSigma1.html">swSigma1</a>()</code>,
<code><a href="swSigma2.html">swSigma2</a>()</code>,
<code><a href="swSigma3.html">swSigma3</a>()</code>,
<code><a href="swSigma4.html">swSigma4</a>()</code>,
<code><a href="swSigmaT.html">swSigmaT</a>()</code>,
<code><a href="swSigmaTheta.html">swSigmaTheta</a>()</code>,
<code><a href="swSoundAbsorption.html">swSoundAbsorption</a>()</code>,
<code><a href="swSoundSpeed.html">swSoundSpeed</a>()</code>,
<code><a href="swSpecificHeat.html">swSpecificHeat</a>()</code>,
<code><a href="swSpice.html">swSpice</a>()</code>,
<code><a href="swSpiciness0.html">swSpiciness0</a>()</code>,
<code><a href="swSpiciness1.html">swSpiciness1</a>()</code>,
<code><a href="swSpiciness2.html">swSpiciness2</a>()</code>,
<code><a href="swSstar.html">swSstar</a>()</code>,
<code><a href="swTFreeze.html">swTFreeze</a>()</code>,
<code><a href="swTSrho.html">swTSrho</a>()</code>,
<code><a href="swThermalConductivity.html">swThermalConductivity</a>()</code>,
<code><a href="swTheta.html">swTheta</a>()</code>,
<code><a href="swViscosity.html">swViscosity</a>()</code>,
<code><a href="swZ.html">swZ</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Left panel: density</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="va">ctd</span><span class="op">[[</span><span class="st">"pressure"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">ylim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">[[</span><span class="st">"sigmaTheta"</span><span class="op">]</span><span class="op">]</span>, <span class="va">p</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, type <span class="op">=</span> <span class="st">"l"</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">sigma</span><span class="op">[</span><span class="va">theta</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Right panel: N2, with default settings (black) and with df=2 (red)</span></span></span>
<span class="r-in"><span><span class="va">N2</span> <span class="op">&lt;-</span> <span class="fu">swN2</span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">N2</span>, <span class="va">p</span>, ylim <span class="op">=</span> <span class="va">ylim</span>, xlab <span class="op">=</span> <span class="st">"N2 [1/s^2]"</span>, ylab <span class="op">=</span> <span class="st">"p"</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu">swN2</span><span class="op">(</span><span class="va">ctd</span>, df <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="va">p</span>, col <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="swN2-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer></div>





  </body></html>

