<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot Temperature-Salinity Diagram — plotTS • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot Temperature-Salinity Diagram — plotTS"><meta name="description" content="Creates a temperature-salinity plot for a CTD cast, with labeled isopycnals."><meta property="og:description" content="Creates a temperature-salinity plot for a CTD cast, with labeled isopycnals."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot Temperature-Salinity Diagram</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/ctd.R" class="external-link"><code>R/ctd.R</code></a></small>
      <div class="d-none name"><code>plotTS.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a temperature-salinity plot for a CTD cast, with labeled isopycnals.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plotTS</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  inSitu <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"p"</span>,</span>
<span>  referencePressure <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  nlevels <span class="op">=</span> <span class="fl">6</span>,</span>
<span>  <span class="va">levels</span>,</span>
<span>  grid <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  col.grid <span class="op">=</span> <span class="st">"lightgray"</span>,</span>
<span>  lty.grid <span class="op">=</span> <span class="st">"dotted"</span>,</span>
<span>  rho1000 <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  eos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceEOS"</span>, default <span class="op">=</span> <span class="st">"gsw"</span><span class="op">)</span>,</span>
<span>  cex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"col"</span><span class="op">)</span>,</span>
<span>  pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"pch"</span><span class="op">)</span>,</span>
<span>  bg <span class="op">=</span> <span class="st">"white"</span>,</span>
<span>  pt.bg <span class="op">=</span> <span class="st">"transparent"</span>,</span>
<span>  col.rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  cex.rho <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fl">4</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"cex"</span><span class="op">)</span>,</span>
<span>  rotate <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  useSmoothScatter <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">xlab</span>,</span>
<span>  <span class="va">ylab</span>,</span>
<span>  <span class="va">Slim</span>,</span>
<span>  <span class="va">Tlim</span>,</span>
<span>  drawFreezing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trimIsopycnals <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  gridIsopycnals <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>  mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceMgp"</span><span class="op">)</span>,</span>
<span>  mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mgp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.5</span>, <span class="va">mgp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="fl">1.5</span>, <span class="va">mgp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">mgp</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>,</span>
<span>  lty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lty"</span><span class="op">)</span>,</span>
<span>  lwd.rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lwd"</span><span class="op">)</span>,</span>
<span>  lty.rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"lty"</span><span class="op">)</span>,</span>
<span>  add <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  inset <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <a href="ctd-class.html">ctd</a>, <a href="argo-class.html">argo</a> or <a href="section-class.html">section</a> object, or a list
containing solely <a href="ctd-class.html">ctd</a> objects or <a href="argo-class.html">argo</a> objects.</p></dd>


<dt id="arg-insitu">inSitu<a class="anchor" aria-label="anchor" href="#arg-insitu"></a></dt>
<dd><p>A boolean indicating whether to use in-situ temperature or
(the default) potential temperature, calculated with reference pressure
given by <code>referencePressure</code>.  This is ignored if <code>eos="gsw"</code>,
because those cases the y axis is necessarily the conservative formulation
of temperature.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>representation of data, <code>"p"</code> for points, <code>"l"</code> for
connecting lines, <code>"b"</code> for spaced connecting lines, or <code>"n"</code>
for no indication.</p></dd>


<dt id="arg-referencepressure">referencePressure<a class="anchor" aria-label="anchor" href="#arg-referencepressure"></a></dt>
<dd><p>reference pressure, to be used in calculating
potential temperature, if <code>inSitu</code> is <code>FALSE</code>.</p></dd>


<dt id="arg-nlevels">nlevels<a class="anchor" aria-label="anchor" href="#arg-nlevels"></a></dt>
<dd><p>Number of automatically-selected isopycnal levels (ignored if
<code>levels</code> is supplied).</p></dd>


<dt id="arg-levels">levels<a class="anchor" aria-label="anchor" href="#arg-levels"></a></dt>
<dd><p>Optional vector of desired isopycnal levels.</p></dd>


<dt id="arg-grid">grid<a class="anchor" aria-label="anchor" href="#arg-grid"></a></dt>
<dd><p>a flag that can be set to <code>TRUE</code> to get a grid.</p></dd>


<dt id="arg-col-grid">col.grid<a class="anchor" aria-label="anchor" href="#arg-col-grid"></a></dt>
<dd><p>color for grid.</p></dd>


<dt id="arg-lty-grid">lty.grid<a class="anchor" aria-label="anchor" href="#arg-lty-grid"></a></dt>
<dd><p>line type for grid.</p></dd>


<dt id="arg-rho-">rho1000<a class="anchor" aria-label="anchor" href="#arg-rho-"></a></dt>
<dd><p>if TRUE, label isopycnals as e.g. 1024; if FALSE, label as
e.g. 24</p></dd>


<dt id="arg-eos">eos<a class="anchor" aria-label="anchor" href="#arg-eos"></a></dt>
<dd><p>equation of state to be used, either <code>"unesco"</code> or
<code>"gsw"</code>.</p></dd>


<dt id="arg-cex">cex<a class="anchor" aria-label="anchor" href="#arg-cex"></a></dt>
<dd><p>character-expansion factor for symbols, as in <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a><code>("cex")</code>.</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>color for symbols.</p></dd>


<dt id="arg-pch">pch<a class="anchor" aria-label="anchor" href="#arg-pch"></a></dt>
<dd><p>symbol type, as in <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a><code>("pch")</code>.</p></dd>


<dt id="arg-bg">bg<a class="anchor" aria-label="anchor" href="#arg-bg"></a></dt>
<dd><p>optional color to be painted under plotting area, before
plotting.  (This is useful for cases in which <code>inset=TRUE</code>.)</p></dd>


<dt id="arg-pt-bg">pt.bg<a class="anchor" aria-label="anchor" href="#arg-pt-bg"></a></dt>
<dd><p>inside color for symbols with <code>pch</code> in 21:25</p></dd>


<dt id="arg-col-rho">col.rho<a class="anchor" aria-label="anchor" href="#arg-col-rho"></a></dt>
<dd><p>color for isopycnal lines and their labels.</p></dd>


<dt id="arg-cex-rho">cex.rho<a class="anchor" aria-label="anchor" href="#arg-cex-rho"></a></dt>
<dd><p>size of the isopycnal labels.</p></dd>


<dt id="arg-rotate">rotate<a class="anchor" aria-label="anchor" href="#arg-rotate"></a></dt>
<dd><p>if TRUE, labels in right-hand margin are written vertically</p></dd>


<dt id="arg-usesmoothscatter">useSmoothScatter<a class="anchor" aria-label="anchor" href="#arg-usesmoothscatter"></a></dt>
<dd><p>if TRUE, use <code><a href="https://rdrr.io/r/graphics/smoothScatter.html" class="external-link">smoothScatter()</a></code> to plot the
points.</p></dd>


<dt id="arg-xlab">xlab<a class="anchor" aria-label="anchor" href="#arg-xlab"></a></dt>
<dd><p>optional label for the x axis, with default "Salinity [PSU]".</p></dd>


<dt id="arg-ylab">ylab<a class="anchor" aria-label="anchor" href="#arg-ylab"></a></dt>
<dd><p>optional label for the y axis, with default "Temperature [C]".</p></dd>


<dt id="arg-slim">Slim<a class="anchor" aria-label="anchor" href="#arg-slim"></a></dt>
<dd><p>optional limits for salinity axis, otherwise inferred from visible data
(i.e. the data that have finite values for both salinity and temperature).</p></dd>


<dt id="arg-tlim">Tlim<a class="anchor" aria-label="anchor" href="#arg-tlim"></a></dt>
<dd><p>as <code>Slim</code>, but for temperature.</p></dd>


<dt id="arg-drawfreezing">drawFreezing<a class="anchor" aria-label="anchor" href="#arg-drawfreezing"></a></dt>
<dd><p>logical indication of whether to draw a freezing-point
line. This is based on zero pressure. If <code>eos="unesco"</code> then
<code><a href="swTFreeze.html">swTFreeze()</a></code> is used to compute the curve, whereas if
<code>eos="gsw"</code> then <code><a href="http://teos-10.github.io/GSW-R/reference/gsw_CT_freezing.html" class="external-link">gsw::gsw_CT_freezing()</a></code> is used;
in each case, zero pressure is used.</p></dd>


<dt id="arg-trimisopycnals">trimIsopycnals<a class="anchor" aria-label="anchor" href="#arg-trimisopycnals"></a></dt>
<dd><p>logical value (<code>TRUE</code> by default) that
indicates whether to trim isopycnal curves
to the region of temperature-salinity space for which density
computations are considered to be valid in the context of the
chosen <code>eos</code>; see “Details”.</p></dd>


<dt id="arg-gridisopycnals">gridIsopycnals<a class="anchor" aria-label="anchor" href="#arg-gridisopycnals"></a></dt>
<dd><p>a parameter that controls how the isopycnals
are computed.  This may be NULL, or an integer vector of length 2.
<em>Case 1:</em> the isopycnals are drawn by tracing density
isopleths in salinity-temperature space. This method was
used as the default prior to version 1.7-11, but it was
found to yield staircase-like isopycnal curves for highly
zoomed-in plots (e.g. with millidegree temperature ranges).
<em>Case 2:</em> a grid of density is constructed, with <code>gridIsopycnals[1]</code>
salinity levels and <code>gridIsopycnals[2]</code> temperature levels, and
then <code><a href="https://rdrr.io/r/grDevices/contourLines.html" class="external-link">contourLines()</a></code> is used to trace the isopycnals.</p></dd>


<dt id="arg-mgp">mgp<a class="anchor" aria-label="anchor" href="#arg-mgp"></a></dt>
<dd><p>3-element numerical vector to use for <code>[par](mgp)</code>, and also
for <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a><code>(mar)</code>, computed from this.  The default is tighter than the R
default, in order to use more space for the data and less for the axes.</p></dd>


<dt id="arg-mar">mar<a class="anchor" aria-label="anchor" href="#arg-mar"></a></dt>
<dd><p>value to be used with <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a><code>("mar")</code>.  If set to
<code>NULL</code>, then <a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a><code>("mar")</code> is used.  A good choice for a TS diagram
with a palette to the right is <code>mar=par("mar")+c(0, 0, 0, 1))</code>.</p></dd>


<dt id="arg-lwd">lwd<a class="anchor" aria-label="anchor" href="#arg-lwd"></a></dt>
<dd><p>line width of lines or symbols.</p></dd>


<dt id="arg-lty">lty<a class="anchor" aria-label="anchor" href="#arg-lty"></a></dt>
<dd><p>line type of lines or symbols.</p></dd>


<dt id="arg-lwd-rho">lwd.rho<a class="anchor" aria-label="anchor" href="#arg-lwd-rho"></a></dt>
<dd><p>line width for density curves.</p></dd>


<dt id="arg-lty-rho">lty.rho<a class="anchor" aria-label="anchor" href="#arg-lty-rho"></a></dt>
<dd><p>line type for density curves.</p></dd>


<dt id="arg-add">add<a class="anchor" aria-label="anchor" href="#arg-add"></a></dt>
<dd><p>a flag that controls whether to add to an existing plot.  (It
makes sense to use <code>add=TRUE</code> in the <code>panel</code> argument of a
<code><a href="https://rdrr.io/r/graphics/coplot.html" class="external-link">coplot()</a></code>, for example.)</p></dd>


<dt id="arg-inset">inset<a class="anchor" aria-label="anchor" href="#arg-inset"></a></dt>
<dd><p>set to <code>TRUE</code> for use within <code><a href="plotInset.html">plotInset()</a></code>.  The
effect is to prevent the present function from adjusting margins, which is
necessary because margin adjustment is the basis for the method used by
<code><a href="plotInset.html">plotInset()</a></code>.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>a flag that turns on debugging.  Set to 1 to get a moderate
amount of debugging information, or to 2 to get more.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>optional arguments passed to plotting functions.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list is silently returned, containing <code>xat</code> and <code>yat</code>,
values that can be used by <code><a href="oce.grid.html">oce.grid()</a></code> to add a grid to the plot.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The isopycnal curves (along which density is constant) are
drawn with <code><a href="drawIsopycnals.html">drawIsopycnals()</a></code>, which also places
labels in the margins showing density minus 1000 \(kg/m^3\).
If <code>trimIsopycnals</code> is <code>TRUE</code> (which is the default), these curves
are trimmed to the region within which the results of density calculation
in the chosen equation of state (<code>eos</code>) are considered to be reliable.</p>
<p>With <code>eos="unesco"</code> this region includes
Practical Salinity from 0 to 42 and Potential Temperature
from -2C to 40C, in accordance with Fofonoff and Millard
(1983, page 23).</p>
<p>With <code>eos="gsw"</code> the lower
limit of Absolute Salinity validity is taken as 0 g/kg,
in accordance with both McDougall et al. (2003 section 3)
and the TEOS-10/gsw Matlab code for the so-called "funnel" of validity.
However, an appropriate upper limit on Absolute Salinity is not as clear.
Here, the value 42 g/kg is chosen to match the "funnel" Matlab code
as of July 2020, but two other choices might have been
made. One is 50 g/kg, since <code><a href="http://teos-10.github.io/GSW-R/reference/gsw_SA_from_rho.html" class="external-link">gsw::gsw_SA_from_rho()</a></code> returns <code>NA</code> values
for Absolute Salinities exceeding that value, and another is
40 g/kg, as in McDougall et al. (2003 section 3).
The Conservative Temperature range is set to run from -2C
to 33C, as in McDougall et al. (2003 section 3), even though the
"funnel" imposes no upper limit on this variable.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p>Fofonoff, N. P., and R. C. Millard.
"Algorithms for Computation of Fundamental Properties of Seawater."
UNESCO Technical Papers in Marine Research. SCOR working group on Evaluation of CTD data;
UNESCO/ICES/SCOR/IAPSO Joint Panel on Oceanographic Tables and Standards, 1983.
<code>https://unesdoc.unesco.org/ark:/48223/pf0000059832</code>.</p></li>
<li><p>McDougall, Trevor J., David R. Jackett, Daniel G. Wright, and Rainer Feistel.
"Accurate and Computationally Efficient Algorithms for Potential Temperature and Density of Seawater."
Journal of Atmospheric and Oceanic Technology 20, no. 5 (May 1, 2003): 730-41.
<code>https://journals.ametsoc.org/jtech/article/20/5/730/2543/Accurate-and-Computationally-Efficient-Algorithms</code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary-ctd-method.html">summary,ctd-method()</a></code> summarizes the information, while
<code><a href="read.ctd.html">read.ctd()</a></code> scans it from a file.</p>
<p>Other functions that plot oce data:
<code><a href="download.amsr.html">download.amsr</a>()</code>,
<code><a href="plot-adp-method.html">plot,adp-method</a></code>,
<code><a href="plot-adv-method.html">plot,adv-method</a></code>,
<code><a href="plot-amsr-method.html">plot,amsr-method</a></code>,
<code><a href="plot-argo-method.html">plot,argo-method</a></code>,
<code><a href="plot-bremen-method.html">plot,bremen-method</a></code>,
<code><a href="plot-cm-method.html">plot,cm-method</a></code>,
<code><a href="plot-coastline-method.html">plot,coastline-method</a></code>,
<code><a href="plot-ctd-method.html">plot,ctd-method</a></code>,
<code><a href="plot-gps-method.html">plot,gps-method</a></code>,
<code><a href="plot-ladp-method.html">plot,ladp-method</a></code>,
<code><a href="plot-landsat-method.html">plot,landsat-method</a></code>,
<code><a href="plot-lisst-method.html">plot,lisst-method</a></code>,
<code><a href="plot-lobo-method.html">plot,lobo-method</a></code>,
<code><a href="plot-met-method.html">plot,met-method</a></code>,
<code><a href="plot-odf-method.html">plot,odf-method</a></code>,
<code><a href="plot-rsk-method.html">plot,rsk-method</a></code>,
<code><a href="plot-satellite-method.html">plot,satellite-method</a></code>,
<code><a href="plot-sealevel-method.html">plot,sealevel-method</a></code>,
<code><a href="plot-section-method.html">plot,section-method</a></code>,
<code><a href="plot-tidem-method.html">plot,tidem-method</a></code>,
<code><a href="plot-topo-method.html">plot,topo-method</a></code>,
<code><a href="plot-windrose-method.html">plot,windrose-method</a></code>,
<code><a href="plot-xbt-method.html">plot,xbt-method</a></code>,
<code><a href="plotProfile.html">plotProfile</a>()</code>,
<code><a href="plotScan.html">plotScan</a>()</code>,
<code><a href="tidem-class.html">tidem-class</a></code></p>
<p>Other things related to ctd data:
<code><a href="CTD_BCD2014666_008_1_DN.ODF.gz.html">CTD_BCD2014666_008_1_DN.ODF.gz</a></code>,
<code><a href="sub-sub-ctd-method.html">[[,ctd-method</a></code>,
<code>[[&lt;-,ctd-method</code>,
<code><a href="as.ctd.html">as.ctd</a>()</code>,
<code><a href="cnvName2oceName.html">cnvName2oceName</a>()</code>,
<code><a href="ctd.html">ctd</a></code>,
<code><a href="ctd-class.html">ctd-class</a></code>,
<code><a href="ctd.cnv.gz.html">ctd.cnv.gz</a></code>,
<code><a href="ctdDecimate.html">ctdDecimate</a>()</code>,
<code><a href="ctdFindProfiles.html">ctdFindProfiles</a>()</code>,
<code><a href="ctdFindProfilesRBR.html">ctdFindProfilesRBR</a>()</code>,
<code><a href="ctdRaw.html">ctdRaw</a></code>,
<code><a href="ctdRepair.html">ctdRepair</a>()</code>,
<code><a href="ctdTrim.html">ctdTrim</a>()</code>,
<code><a href="ctd_aml_type1.csv.gz.html">ctd_aml_type1.csv.gz</a></code>,
<code><a href="ctd_aml_type3.csv.gz.html">ctd_aml_type3.csv.gz</a></code>,
<code><a href="d200321-001.ctd.gz.html">d200321-001.ctd.gz</a></code>,
<code><a href="d201211_0011.cnv.gz.html">d201211_0011.cnv.gz</a></code>,
<code><a href="handleFlags-ctd-method.html">handleFlags,ctd-method</a></code>,
<code><a href="initialize-ctd-method.html">initialize,ctd-method</a></code>,
<code><a href="initializeFlagScheme-ctd-method.html">initializeFlagScheme,ctd-method</a></code>,
<code><a href="oceNames2whpNames.html">oceNames2whpNames</a>()</code>,
<code><a href="oceUnits2whpUnits.html">oceUnits2whpUnits</a>()</code>,
<code><a href="plot-ctd-method.html">plot,ctd-method</a></code>,
<code><a href="plotProfile.html">plotProfile</a>()</code>,
<code><a href="plotScan.html">plotScan</a>()</code>,
<code><a href="read.ctd.html">read.ctd</a>()</code>,
<code><a href="read.ctd.aml.html">read.ctd.aml</a>()</code>,
<code><a href="read.ctd.itp.html">read.ctd.itp</a>()</code>,
<code><a href="read.ctd.odf.html">read.ctd.odf</a>()</code>,
<code><a href="read.ctd.odv.html">read.ctd.odv</a>()</code>,
<code><a href="read.ctd.saiv.html">read.ctd.saiv</a>()</code>,
<code><a href="read.ctd.sbe.html">read.ctd.sbe</a>()</code>,
<code><a href="read.ctd.ssda.html">read.ctd.ssda</a>()</code>,
<code><a href="read.ctd.woce.html">read.ctd.woce</a>()</code>,
<code><a href="read.ctd.woce.other.html">read.ctd.woce.other</a>()</code>,
<code><a href="setFlags-ctd-method.html">setFlags,ctd-method</a></code>,
<code><a href="subset-ctd-method.html">subset,ctd-method</a></code>,
<code><a href="summary-ctd-method.html">summary,ctd-method</a></code>,
<code><a href="woceNames2oceNames.html">woceNames2oceNames</a>()</code>,
<code><a href="woceUnit2oceUnit.html">woceUnit2oceUnit</a>()</code>,
<code><a href="write.ctd.html">write.ctd</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># 1. ctd object</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotTS</span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTS-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 2. section object (note the outlier!)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">section</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotTS</span><span class="op">(</span><span class="va">section</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTS-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 3. argo object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">argo</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotTS</span><span class="op">(</span><span class="fu"><a href="handleFlags.html">handleFlags</a></span><span class="op">(</span><span class="va">argo</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTS-3.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 4. oxygen-based colormap</span></span></span>
<span class="r-in"><span><span class="va">marOrig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"mar"</span><span class="op">)</span> <span class="co"># so later plots with palettes have same margins</span></span></span>
<span class="r-in"><span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="colormap.html">colormap</a></span><span class="op">(</span><span class="va">section</span><span class="op">[[</span><span class="st">"oxygen"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="drawPalette.html">drawPalette</a></span><span class="op">(</span>colormap <span class="op">=</span> <span class="va">cm</span>, zlab <span class="op">=</span> <span class="st">"Oxygen"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotTS</span><span class="op">(</span><span class="va">section</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="va">cm</span><span class="op">$</span><span class="va">zcol</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"mar"</span><span class="op">)</span><span class="op">)</span> <span class="co"># the mar adjusts for the palette</span></span></span>
<span class="r-plt img"><img src="plotTS-4.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 5. waters near Gulf Stream, colour-coded for longitude.</span></span></span>
<span class="r-in"><span><span class="va">sec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">section</span>, <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">longitude</span> <span class="op">+</span> <span class="fl">71.6</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cm</span> <span class="op">&lt;-</span> <span class="fu"><a href="colormap.html">colormap</a></span><span class="op">(</span><span class="va">sec</span><span class="op">[[</span><span class="st">"longitude"</span>, <span class="st">"byStation"</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="va">oceColors9B</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.3</span>, <span class="fl">3.3</span>, <span class="fl">1</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="drawPalette.html">drawPalette</a></span><span class="op">(</span>colormap <span class="op">=</span> <span class="va">cm</span>, zlab <span class="op">=</span> <span class="st">"Longitude"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotTS</span><span class="op">(</span><span class="va">sec</span>, type <span class="op">=</span> <span class="st">"n"</span>, xaxs <span class="op">=</span> <span class="st">"r"</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"mar"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">jnk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mapply.html" class="external-link">mapply</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="kw">function</span><span class="op">(</span><span class="va">s</span>, <span class="va">col</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>        <span class="fu">plotTS</span><span class="op">(</span><span class="va">s</span>, type <span class="op">=</span> <span class="st">"o"</span>, col <span class="op">=</span> <span class="st">"gray"</span>, pt.bg <span class="op">=</span> <span class="va">col</span>, pch <span class="op">=</span> <span class="fl">21</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span>,</span></span>
<span class="r-in"><span>    <span class="va">sec</span><span class="op">[[</span><span class="st">"station"</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    col <span class="op">=</span> <span class="va">cm</span><span class="op">$</span><span class="va">zcol</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTS-5.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 6. with added spiciness contours</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plotTS</span><span class="op">(</span><span class="va">ctd</span>, eos <span class="op">=</span> <span class="st">"gsw"</span><span class="op">)</span> <span class="co"># MANDATORY so x=SA and y=CT</span></span></span>
<span class="r-in"><span><span class="va">usr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"usr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">SAgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">usr</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">CTgrid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="va">usr</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, <span class="va">usr</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span>SA <span class="op">=</span> <span class="va">SAgrid</span>, CT <span class="op">=</span> <span class="va">CTgrid</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">spiciness</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu">gsw</span><span class="fu">::</span><span class="fu"><a href="http://teos-10.github.io/GSW-R/reference/gsw_spiciness0.html" class="external-link">gsw_spiciness0</a></span><span class="op">(</span><span class="va">g</span><span class="op">$</span><span class="va">SA</span>, <span class="va">g</span><span class="op">$</span><span class="va">CT</span><span class="op">)</span>, nrow <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">SAgrid</span>, <span class="va">CTgrid</span>, <span class="va">spiciness</span>, col <span class="op">=</span> <span class="fl">2</span>, labcex <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plotTS-6.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.9000.</p>
</div>

    </footer></div>





  </body></html>

