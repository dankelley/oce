<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Welch Periodogram — pwelch • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Welch Periodogram — pwelch"><meta name="description" content="Compute periodogram using the Welch (1967) method. This is
somewhat analogous to the Matlab function of the same name,
but it is not intended as a drop-in replacement."><meta property="og:description" content="Compute periodogram using the Welch (1967) method. This is
somewhat analogous to the Matlab function of the same name,
but it is not intended as a drop-in replacement."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Welch Periodogram</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/spectral.R" class="external-link"><code>R/spectral.R</code></a></small>
      <div class="d-none name"><code>pwelch.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Compute periodogram using the Welch (1967) method. This is
somewhat analogous to the Matlab function of the same name,
but it is <em>not</em> intended as a drop-in replacement.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pwelch</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">window</span>,</span>
<span>  <span class="va">noverlap</span>,</span>
<span>  <span class="va">nfft</span>,</span>
<span>  <span class="va">fs</span>,</span>
<span>  <span class="va">spec</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detrend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a vector or timeseries to be analyzed.  If <code>x</code> is a timeseries, then
it there is no need to <code>fs</code>, and doing so will result in an error if it does
not match the value inferred from <code>x</code>.</p></dd>


<dt id="arg-window">window<a class="anchor" aria-label="anchor" href="#arg-window"></a></dt>
<dd><p>optional numeric vector specifying a window to be applied
to the timeseries subsamples.  This is ignored if <code>spec</code> is provided.
Otherwise, if <code>window</code> is provided, then it must either
be of the same length as <code>nfft</code> or be of length 1.  In the first case,
the vector is multiplied into the timeseries subsample, and the length
of <code>window</code> must equal <code>nfft</code> is that is supplied.
In the second then <code>window</code> is taken to be the number
of sub-intervals into which the time series is to be broken up, with a
hamming window being used for each sub-interval.  If <code>window</code> is not
specified and <code>nfft</code> is given, then the window is constructed as
a hamming window with length <code>nfft</code>.  And, if neither <code>window</code>
nor <code>nfft</code> are specified, then <code>x</code> will be broken up
into 8 portions.</p></dd>


<dt id="arg-noverlap">noverlap<a class="anchor" aria-label="anchor" href="#arg-noverlap"></a></dt>
<dd><p>number of points to overlap between windows.  If not
specified, this will be set to half the window length.</p></dd>


<dt id="arg-nfft">nfft<a class="anchor" aria-label="anchor" href="#arg-nfft"></a></dt>
<dd><p>length of FFT. See <code>window</code> for how <code>nfft</code> interacts with
that argument.</p></dd>


<dt id="arg-fs">fs<a class="anchor" aria-label="anchor" href="#arg-fs"></a></dt>
<dd><p>frequency of time-series.  If <code>x</code> is a time-series, and if
<code>fs</code> is supplied, then time-series is altered to have frequency
<code>fs</code>.</p></dd>


<dt id="arg-spec">spec<a class="anchor" aria-label="anchor" href="#arg-spec"></a></dt>
<dd><p>optional function to be used for the computation of the spectrum,
to allow finer-grained control of the processing.
If provided, <code>spec</code> must accept a time-series as its first argument, and
must return a list containing the spectrum in <code>spec</code> and the
frequency in <code>freq</code>.
Note that no window will be applied to the data after subsampling,
and an error will be reported if <code>window</code> and <code>spec</code> are both given.
An error will be reported if <code>spec</code> is given but <code>nfft</code> is not given.
Note that the values of <code>demean</code>, <code>detrend</code> and <code>plot</code> are ignored if <code>spec</code>
is given. However, the ... argument <em>is</em> passed to <code>spec</code>.</p></dd>


<dt id="arg-demean-detrend">demean, detrend<a class="anchor" aria-label="anchor" href="#arg-demean-detrend"></a></dt>
<dd><p>logical values that can control the spectrum calculation,
in the default case of <code>spec</code>.  These are passed to <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code> and thence
<code><a href="https://rdrr.io/r/stats/spec.pgram.html" class="external-link">spec.pgram()</a></code>; see the help pages for the latter for an explanation.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical, set to <code>TRUE</code> to plot the spectrum.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>a flag that turns on debugging.  Set to 1 to get a moderate
amount of debugging information, or to 2 to get more.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>optional extra arguments to be passed to
<code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>, or to <code>spec</code>, if the latter is given.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>pwelch</code> returns a list mimicking the return value from <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>,
containing frequency <code>freq</code>, spectral power <code>spec</code>, degrees of
freedom <code>df</code>, bandwidth <code>bandwidth</code>, etc.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>First, <code>x</code> is broken up into chunks,
overlapping as specified by <code>noverlap</code>.  These chunks are then
multiplied by the window, and then
passed to <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>.  The resulting spectra are then averaged,
with the results being stored in <code>spec</code> of the return value.  Other
entries of the return value mimic those returned by <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>.</p>
<p>It should be noted that the actions of several parameters are interlocked,
so this can be a complex function to use.  For example, if <code>window</code> is
given and has length exceeding 1, then its length must equal <code>nfft</code>, if the
latter is also provided.</p>
    </div>
    <div class="section level2">
    <h2 id="bugs">Bugs<a class="anchor" aria-label="anchor" href="#bugs"></a></h2>


<p>Both bandwidth and degrees of freedom are just copied from
the values for one of the chunk spectra, and are thus incorrect.  That means
the cross indicated on the graph is also incorrect.</p>
    </div>
    <div class="section level2">
    <h2 id="historical-notes">Historical notes<a class="anchor" aria-label="anchor" href="#historical-notes"></a></h2>


<ul><li><p><strong>2021-06-26:</strong> Until this date, <code>pwelch()</code> passed the
subsampled timeseries portions through <code><a href="detrend.html">detrend()</a></code>
before applying the window. This practice was dropped
because it could lead to over-estimates of low frequency
energy (as noticed by Holger Foysi of the University of Siegen),
perhaps because <code><a href="detrend.html">detrend()</a></code> considers only endpoints and
therefore can yield inaccurate trend estimates.
In a related change, <code>demean</code> and <code>detrend</code> were added
as formal arguments, to avoid users having to trace the documentation
for <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code> and then <code><a href="https://rdrr.io/r/stats/spec.pgram.html" class="external-link">spec.pgram()</a></code>, to learn how to
remove means and trends from data.
For more control, the <code>spec</code> argument was
added to let users sidestep <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code> entirely, by providing
their own spectral computation functions.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Welch, P. D., 1967. The Use of Fast Fourier Transform for the
Estimation of Power Spectra: A Method Based on Time Averaging Over Short,
Modified Periodograms. <em>IEEE Transactions on Audio Electroacoustics</em>,
AU-15, 70–73.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Fs</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.296</span>, <span class="fl">1</span> <span class="op">/</span> <span class="va">Fs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="fl">200</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">x</span>, frequency <span class="op">=</span> <span class="va">Fs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">X</span>, spans <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"random + 200 Hz"</span>, log <span class="op">=</span> <span class="st">"no"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">pwelch</span><span class="op">(</span><span class="va">X</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">freq</span>, <span class="va">w</span><span class="op">$</span><span class="va">spec</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu">pwelch</span><span class="op">(</span><span class="va">X</span>, nfft <span class="op">=</span> <span class="fl">75</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">w2</span><span class="op">$</span><span class="va">freq</span>, <span class="va">w2</span><span class="op">$</span><span class="va">spec</span>, col <span class="op">=</span> <span class="st">"green"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fl">200</span>, col <span class="op">=</span> <span class="st">"blue"</span>, lty <span class="op">=</span> <span class="st">"dotted"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pwelch-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Checking spectral levels with Parseval's theorem:\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking spectral levels with Parseval's theorem:</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"var(x)                              = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> var(x)                              =  1.399508 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"2 * sum(s$spec) * diff(s$freq[1:2]) = "</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 * sum(s$spec) * diff(s$freq[1:2]) =  1.452406 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"sum(w$spec) * diff(s$freq[1:2])     = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum(w$spec) * diff(s$freq[1:2])     =  0.6915331 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"sum(w2$spec) * diff(s$freq[1:2])    = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w2</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">w2</span><span class="op">$</span><span class="va">freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum(w2$spec) * diff(s$freq[1:2])    =  0.7083285 </span>
<span class="r-in"><span><span class="co"># co2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span>, mgp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0.7</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">co2</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span>, <span class="va">s</span><span class="op">$</span><span class="va">spec</span> <span class="op">*</span> <span class="va">s</span><span class="op">$</span><span class="va">freq</span>,</span></span>
<span class="r-in"><span>    xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span> <span class="op">*</span> <span class="va">Frequency</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Power*Frequency"</span>, type <span class="op">=</span> <span class="st">"l"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Variance-preserving spectrum"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pw</span> <span class="op">&lt;-</span> <span class="fu">pwelch</span><span class="op">(</span><span class="va">co2</span>, nfft <span class="op">=</span> <span class="fl">256</span>, plot <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pw</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span>, <span class="va">pw</span><span class="op">$</span><span class="va">spec</span> <span class="op">*</span> <span class="va">pw</span><span class="op">$</span><span class="va">freq</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pwelch-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

