<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Welch periodogram — pwelch • oce</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Welch periodogram — pwelch"><meta property="og:description" content="Compute periodogram using the Welch (1967) method. This is
somewhat analogous to the Matlab function of the same name,
but it is not intended as a drop-in replacement."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.8-2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A_oce.html">1. Introduction to Oce</a>
    </li>
    <li>
      <a href="../articles/B_ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/D_map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/E_flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/F_subclassing.html">6. Subclassing oce objects</a>
    </li>
    <li>
      <a href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dankelley/oce/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Welch periodogram</h1>
    <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/spectral.R" class="external-link"><code>R/spectral.R</code></a></small>
    <div class="hidden name"><code>pwelch.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Compute periodogram using the Welch (1967) method. This is
somewhat analogous to the Matlab function of the same name,
but it is <em>not</em> intended as a drop-in replacement.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pwelch</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">window</span>,</span>
<span>  <span class="va">noverlap</span>,</span>
<span>  <span class="va">nfft</span>,</span>
<span>  <span class="va">fs</span>,</span>
<span>  <span class="va">spec</span>,</span>
<span>  demean <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detrend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a vector or timeseries to be analyzed.  If <code>x</code> is a timeseries, then
it there is no need to <code>fs</code>, and doing so will result in an error if it does
not match the value inferred from <code>x</code>.</p></dd>


<dt>window</dt>
<dd><p>optional numeric vector specifying a window to be applied
to the timeseries subsamples.  This is ignored if <code>spec</code> is provided.
Otherwise, if <code>window</code> is provided, then it must either
be of the same length as <code>nfft</code> or be of length 1.  In the first case,
the vector is multiplied into the timeseries subsample, and the length
of <code>window</code> must equal <code>nfft</code> is that is supplied.
In the second then <code>window</code> is taken to be the number
of sub-intervals into which the time series is to be broken up, with a
hamming window being used for each sub-interval.  If <code>window</code> is not
specified and <code>nfft</code> is given, then the window is constructed as
a hamming window with length <code>nfft</code>.  And, if neither <code>window</code>
nor <code>nfft</code> are specified, then <code>x</code> will be broken up
into 8 portions.</p></dd>


<dt>noverlap</dt>
<dd><p>number of points to overlap between windows.  If not
specified, this will be set to half the window length.</p></dd>


<dt>nfft</dt>
<dd><p>length of FFT. See <code>window</code> for how <code>nfft</code> interacts with
that argument.</p></dd>


<dt>fs</dt>
<dd><p>frequency of time-series.  If <code>x</code> is a time-series, and if
<code>fs</code> is supplied, then time-series is altered to have frequency
<code>fs</code>.</p></dd>


<dt>spec</dt>
<dd><p>optional function to be used for the computation of the spectrum,
to allow finer-grained control of the processing.
If provided, <code>spec</code> must accept a time-series as its first argument, and
must return a list containing the spectrum in <code>spec</code> and the
frequency in <code>freq</code>.
Note that no window will be applied to the data after subsampling,
and an error will be reported if <code>window</code> and <code>spec</code> are both given.
An error will be reported if <code>spec</code> is given but <code>nfft</code> is not given.
Note that the values of <code>demean</code>, <code>detrend</code> and <code>plot</code> are ignored if <code>spec</code>
is given. However, the ... argument <em>is</em> passed to <code>spec</code>.</p></dd>


<dt>demean, detrend</dt>
<dd><p>logical values that can control the spectrum calculation,
in the default case of <code>spec</code>.  These are passed to <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code> and thence
<code><a href="https://rdrr.io/r/stats/spec.pgram.html" class="external-link">spec.pgram()</a></code>; see the help pages for the latter for an explanation.</p></dd>


<dt>plot</dt>
<dd><p>logical, set to <code>TRUE</code> to plot the spectrum.</p></dd>


<dt>debug</dt>
<dd><p>a flag that turns on debugging.  Set to 1 to get a moderate
amount of debugging information, or to 2 to get more.</p></dd>


<dt>...</dt>
<dd><p>optional extra arguments to be passed to
<code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>, or to <code>spec</code>, if the latter is given.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p><code>pwelch</code> returns a list mimicking the return value from <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>,
containing frequency <code>freq</code>, spectral power <code>spec</code>, degrees of
freedom <code>df</code>, bandwidth <code>bandwidth</code>, etc.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>First, <code>x</code> is broken up into chunks,
overlapping as specified by <code>noverlap</code>.  These chunks are then
multiplied by the window, and then
passed to <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>.  The resulting spectra are then averaged,
with the results being stored in <code>spec</code> of the return value.  Other
entries of the return value mimic those returned by <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code>.</p>
<p>It should be noted that the actions of several parameters are interlocked,
so this can be a complex function to use.  For example, if <code>window</code> is
given and has length exceeding 1, then its length must equal <code>nfft</code>, if the
latter is also provided.</p>
    </div>
    <div id="bugs">
    <h2>Bugs</h2>
    

<p>Both bandwidth and degrees of freedom are just copied from
the values for one of the chunk spectra, and are thus incorrect.  That means
the cross indicated on the graph is also incorrect.</p>
    </div>
    <div id="historical-notes">
    <h2>Historical notes</h2>
    

<ul><li><p><strong>2021-06-26:</strong> Until this date, <code>pwelch()</code> passed the
subsampled timeseries portions through <code><a href="detrend.html">detrend()</a></code>
before applying the window. This practice was dropped
because it could lead to over-estimates of low frequency
energy (as noticed by Holger Foysi of the University of Siegen),
perhaps because <code><a href="detrend.html">detrend()</a></code> considers only endpoints and
therefore can yield inaccurate trend estimates.
In a related change, <code>demean</code> and <code>detrend</code> were added
as formal arguments, to avoid users having to trace the documentation
for <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code> and then <code><a href="https://rdrr.io/r/stats/spec.pgram.html" class="external-link">spec.pgram()</a></code>, to learn how to
remove means and trends from data.
For more control, the <code>spec</code> argument was
added to let users sidestep <code><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum()</a></code> entirely, by providing
their own spectral computation functions.</p></li>
</ul></div>
    <div id="references">
    <h2>References</h2>
    <p>Welch, P. D., 1967. The Use of Fast Fourier Transform for the
Estimation of Power Spectra: A Method Based on Time Averaging Over Short,
Modified Periodograms. <em>IEEE Transactions on Audio Electroacoustics</em>,
AU-15, 70--73.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Dan Kelley</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">Fs</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.296</span>, <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">*</span> <span class="va">t</span> <span class="op">*</span> <span class="fl">200</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/ts.html" class="external-link">ts</a></span><span class="op">(</span><span class="va">x</span>, frequency<span class="op">=</span><span class="va">Fs</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">X</span>, spans<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">2</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"random + 200 Hz"</span>, log<span class="op">=</span><span class="st">'no'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w</span> <span class="op">&lt;-</span> <span class="fu">pwelch</span><span class="op">(</span><span class="va">X</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">freq</span>, <span class="va">w</span><span class="op">$</span><span class="va">spec</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">w2</span> <span class="op">&lt;-</span> <span class="fu">pwelch</span><span class="op">(</span><span class="va">X</span>, nfft<span class="op">=</span><span class="fl">75</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">w2</span><span class="op">$</span><span class="va">freq</span>, <span class="va">w2</span><span class="op">$</span><span class="va">spec</span>, col<span class="op">=</span><span class="st">'green'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">200</span>, col<span class="op">=</span><span class="st">"blue"</span>, lty<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pwelch-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Checking spectral levels with Parseval's theorem:\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking spectral levels with Parseval's theorem:</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"var(x)                              = "</span>, <span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">var</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> var(x)                              =  1.517421 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"2 * sum(s$spec) * diff(s$freq[1:2]) = "</span>, <span class="fl">2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 * sum(s$spec) * diff(s$freq[1:2]) =  1.59418 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"sum(w$spec) * diff(s$freq[1:2])     = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">w</span><span class="op">$</span><span class="va">freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum(w$spec) * diff(s$freq[1:2])     =  0.7816559 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"sum(w2$spec) * diff(s$freq[1:2])    = "</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">w2</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">w2</span><span class="op">$</span><span class="va">freq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> sum(w2$spec) * diff(s$freq[1:2])    =  0.7709744 </span>
<span class="r-in"><span><span class="co"># co2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">1</span><span class="op">)</span>, mgp<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">0.7</span>,<span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/spectrum.html" class="external-link">spectrum</a></span><span class="op">(</span><span class="va">co2</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">s</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span>, <span class="va">s</span><span class="op">$</span><span class="va">spec</span> <span class="op">*</span> <span class="va">s</span><span class="op">$</span><span class="va">freq</span>,</span></span>
<span class="r-in"><span>     xlab<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">log</span><span class="op">[</span><span class="fl">10</span><span class="op">]</span><span class="op">*</span><span class="va">Frequency</span><span class="op">)</span>, ylab<span class="op">=</span><span class="st">"Power*Frequency"</span>, type<span class="op">=</span><span class="st">'l'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/title.html" class="external-link">title</a></span><span class="op">(</span><span class="st">"Variance-preserving spectrum"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pw</span> <span class="op">&lt;-</span> <span class="fu">pwelch</span><span class="op">(</span><span class="va">co2</span>, nfft<span class="op">=</span><span class="fl">256</span>, plot<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">pw</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span>, <span class="va">pw</span><span class="op">$</span><span class="va">spec</span> <span class="op">*</span> <span class="va">pw</span><span class="op">$</span><span class="va">freq</span>, col<span class="op">=</span><span class="st">'red'</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="pwelch-2.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

