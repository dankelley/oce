<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Read an odf File — read.odf • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Read an odf File — read.odf"><meta name="description" content="ODF (Ocean Data Format) is a
format developed at the Bedford Institute of Oceanography and also used
at other Canadian Department of Fisheries and Oceans (DFO) facilities
(see references 1 and 2).
It can hold various types of time-series data, which includes a variety
of instrument types. Thus, read.odf()
is used by read.ctd.odf for CTD data, etc."><meta property="og:description" content="ODF (Ocean Data Format) is a
format developed at the Bedford Institute of Oceanography and also used
at other Canadian Department of Fisheries and Oceans (DFO) facilities
(see references 1 and 2).
It can hold various types of time-series data, which includes a variety
of instrument types. Thus, read.odf()
is used by read.ctd.odf for CTD data, etc."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Read an odf File</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/odf.R" class="external-link"><code>R/odf.R</code></a></small>
      <div class="d-none name"><code>read.odf.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>ODF (Ocean Data Format) is a
format developed at the Bedford Institute of Oceanography and also used
at other Canadian Department of Fisheries and Oceans (DFO) facilities
(see references 1 and 2).
It can hold various types of time-series data, which includes a variety
of instrument types. Thus, <code>read.odf()</code>
is used by <code>read.ctd.odf</code> for CTD data, etc.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">read.odf</span><span class="op">(</span></span>
<span>  <span class="va">file</span>,</span>
<span>  columns <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  header <span class="op">=</span> <span class="st">"list"</span>,</span>
<span>  exclude <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  encoding <span class="op">=</span> <span class="st">"latin1"</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>the file containing the data.</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p>An optional <a href="https://rdrr.io/r/base/list.html" class="external-link">list</a> that can be used to convert unrecognized
data names to resultant variable names.  For example,
<code>columns=list(salinity=list(name="salt", unit=list(unit=expression(), scale="PSS-78"))</code>
states that a short-name of <code>"salt"</code> represents salinity, and that the unit is
as indicated. This is passed to <code><a href="cnvName2oceName.html">cnvName2oceName()</a></code> or <code><a href="ODFNames2oceNames.html">ODFNames2oceNames()</a></code>,
as appropriate, and takes precedence over the lookup table in that function.</p></dd>


<dt id="arg-header">header<a class="anchor" aria-label="anchor" href="#arg-header"></a></dt>
<dd><p>An indication of whether, or how, to store the entire
ODF file header in the <code>metadata</code> slot of the returned object.
There are three choices for the <code>header</code> argument.
(1) If it is <code>NULL</code>, then the ODF header is not stored in
the <code>metadata</code> slot (although some of its contents are).
(2) If it is <code>"character"</code>, the header is stored within
the <code>metadata</code> as a vector named <code>header</code>, comprising
a character string for each line of the header within the ODF file.
(3) If it is <code>"list"</code>, then the <code>metadata</code> slot of the
returned object will contain a <code>list</code> named <code>header</code> that
has lists as its entries. (The sub-lists are in the form of
key-value pairs.) The naming of list entries is patterned on
that in the ODF header, except that <code><a href="unduplicateNames.html">unduplicateNames()</a></code>
is used to transform repeated names by adding numerical suffices.
Note: on June 6, 2019, the default value of <code>header</code> was
changed from <code>NULL</code> to <code>"list"</code>; in addition, the resultant
list was made to contain every single item in the ODF header, with
<code><a href="unduplicateNames.html">unduplicateNames()</a></code> being used to append integers to
distinguish between repeated names in the ODF format.</p></dd>


<dt id="arg-exclude">exclude<a class="anchor" aria-label="anchor" href="#arg-exclude"></a></dt>
<dd><p>either a character value holding a regular
expression that is used with <code><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep()</a></code> to remove lines from the
header before processing, or <code>NULL</code> (the default), meaning
not to exclude any such lines.  The purpose of this argument
is to solve problems with some files, which can have
thousands of lines that indicate details that are may be of
little value in processing.  For example, some files have thousands
of lines that would be excluded by using
<code>exclude="PROCESS='Nulled the .* value"</code> in the function call.</p></dd>


<dt id="arg-encoding">encoding<a class="anchor" aria-label="anchor" href="#arg-encoding"></a></dt>
<dd><p>a character value that indicates the encoding to be used for
this data file, if it is textual.  The default value for most functions is
<code>"latin1"</code>, which seems to be suitable for files containing text written in
English and French.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <a href="oce-class.html">oce</a> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that some elements of the metadata are particular to ODF objects,
e.g. <code>depthMin</code>, <code>depthMax</code> and <code>sounding</code>, which
are inferred from ODF items named <code>MIN_DEPTH</code>, <code>MAX_DEPTH</code>
and <code>SOUNDING</code>, respectively. In addition, the more common metadata
item <code>waterDepth</code>, which is used in <code>ctd</code> objects to refer to
the total water depth, is set to <code>sounding</code> if that is finite,
or to <code>maxDepth</code> otherwise.</p>
<p>The function <code><a href="ODFNames2oceNames.html">ODFNames2oceNames()</a></code> is used to translate
data names from the ODF file to standard <code>oce</code> names.</p>
    </div>
    <div class="section level2">
    <h2 id="metadata-conventions">Metadata conventions<a class="anchor" aria-label="anchor" href="#metadata-conventions"></a></h2>



<p>Some metadata items may be specific to certain instruments, and
certain research groups. It can be important for analysts to be aware of
the conventions used in datasets that are under study.
For example, as of June 2018, <code>adp</code>
objects created at the Bedford Institute of Oceanography may
have a metadata item named <code>depthOffBottom</code> (called
<code>DEPTH_OFF_BOTTOM</code> in ODF files), which is not typically
present in <code>ctd</code> files. This item illustrates the renaming
convention, from the CAMEL_CASE used in ODF files to the snakeCase
used in oce. Bearing this conversion in mind, users should not
find it difficult to understand the meaning of items that <code>read.odf()</code>
stores within the <code>metadata</code> slot. Users should bear in mind
that the whole ODF header is saved as a list by
calling the function with <code>header="list"</code>, after which
e.g. <a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a><code>(rval[["header"]])</code> or <a href="https://rdrr.io/r/utils/View.html" class="external-link">View</a><code>(rval[["header"]])</code>
can be used to isolate any information of interest (but bear in mind
that suffices are used to disambiguate sibling items of identical
name in the ODF header).</p>
    </div>
    <div class="section level2">
    <h2 id="handling-of-temperature-scales">Handling of temperature scales<a class="anchor" aria-label="anchor" href="#handling-of-temperature-scales"></a></h2>


<p><code>read.odf()</code> stores temperature data directly as read from the file, which
might mean the IPTS-68 scale.  These values should not be used to calculate
other seawater quantities, because formulae are generally based in ITS90
temperatures. To avoid problems, the accessor function converts to the modern
scale, e.g. <code>x[["temperature"]]</code> yields temperature in the ITS90
scale, whether temperatures in the original file were reported on that scale
or the older IPTS-68 scale.</p>
    </div>
    <div class="section level2">
    <h2 id="caution">Caution<a class="anchor" aria-label="anchor" href="#caution"></a></h2>



<p>Lacking detailed documentation of the ODF file format, the <code>read.odf()</code> and
<code><a href="read.ctd.odf.html">read.ctd.odf()</a></code> functions were crafted based on inspection of data files, and
so some guesses had to be made.</p>
<p>The <code>PARAMETER_HEADER</code> chunks describing quality-control flags are
a case in point.  These contain <code>NAME</code> components that
refer to other <code>PARAMETER_HEADER</code> chunks that hold measured data.  However,
those references are not always matched well with the data names, and
even if they do match, the cross-reference syntax used by
the Bedford Institute of Oceanography differs from that used by
l’Institut Maurice-Lamontagne. To simplify coding, it was assumed that
each quality-control sequence applies to the data sequence
immediately preceding it.  (This assumption is made in other
analysis systems.)</p>
<p>It is also prudent to pay attention to the units decoding,
which <code>read.odf()</code> handles by calling <code><a href="unitFromString.html">unitFromString()</a></code>.
Be on the lookout for incorrect temperature scales, which
are sometimes reported with nonstandard strings in ODF files.
Also, note that you may see warnings about conductivity ratios,
which some ODF files incorrectly suggest have dimensions.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>For sources that describe the ODF format, see the documentation
for the <a href="odf-class.html">odf</a> class.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="ODF2oce.html">ODF2oce()</a></code> will be an alternative to this, once (or perhaps if) a <code>ODF</code>
package is released by the Canadian Department of Fisheries and Oceans.</p>
<p>Other things related to odf data:
<code><a href="CTD_BCD2014666_008_1_DN.ODF.gz.html">CTD_BCD2014666_008_1_DN.ODF.gz</a></code>,
<code><a href="ODF2oce.html">ODF2oce</a>()</code>,
<code><a href="ODFListFromHeader.html">ODFListFromHeader</a>()</code>,
<code><a href="ODFNames2oceNames.html">ODFNames2oceNames</a>()</code>,
<code><a href="sub-sub-odf-method.html">[[,odf-method</a></code>,
<code>[[&lt;-,odf-method</code>,
<code><a href="odf-class.html">odf-class</a></code>,
<code><a href="plot-odf-method.html">plot,odf-method</a></code>,
<code><a href="read.ctd.odf.html">read.ctd.odf</a>()</code>,
<code><a href="subset-odf-method.html">subset,odf-method</a></code>,
<code><a href="summary-odf-method.html">summary,odf-method</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley, with help from Chantelle Layton</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># 1. Read a CTD cast made on the Scotian Shelf. Note that the file's metadata</span></span></span>
<span class="r-in"><span><span class="co"># states that conductivity is in S/m, but it is really conductivity ratio,</span></span></span>
<span class="r-in"><span><span class="co"># so we must alter the unit before converting to a CTD object. Note that</span></span></span>
<span class="r-in"><span><span class="co"># read.odf() on this data file produces a warning suggesting that the user</span></span></span>
<span class="r-in"><span><span class="co"># repair the unit, using the method outlined here.</span></span></span>
<span class="r-in"><span><span class="va">odf</span> <span class="op">&lt;-</span> <span class="fu">read.odf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"CTD_BCD2014666_008_1_DN.ODF.gz"</span>, package <span class="op">=</span> <span class="st">"oce"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>"conductivity" (code name "CRAT_01") is a conductivity ratio, which has no units, but the file lists "s/m" as a unit. Consult ?read.odf to see how to rectify this error.</span>
<span class="r-in"><span><span class="va">ctd</span> <span class="op">&lt;-</span> <span class="fu"><a href="as.ctd.html">as.ctd</a></span><span class="op">(</span><span class="va">odf</span><span class="op">)</span> <span class="co"># so we can e.g. extract potential temperature</span></span></span>
<span class="r-in"><span><span class="va">ctd</span><span class="op">[[</span><span class="st">"conductivityUnit"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>unit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="op">)</span>, scale <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># 2. Make a CTD, and plot (with span to show NS)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ctd</span>, span <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="read.odf-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span><span class="co">#</span></span></span>
<span class="r-in"><span><span class="co"># 3. Highlight bad data on TS diagram. (Note that the eos</span></span></span>
<span class="r-in"><span><span class="co"># is specified, because we will extract practical-salinity and</span></span></span>
<span class="r-in"><span><span class="co"># UNESCO-defined potential temperatures for the added points.)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotTS.html">plotTS</a></span><span class="op">(</span><span class="va">ctd</span>, type <span class="op">=</span> <span class="st">"o"</span>, eos <span class="op">=</span> <span class="st">"unesco"</span><span class="op">)</span> <span class="co"># use a line to show loops</span></span></span>
<span class="r-in"><span><span class="va">bad</span> <span class="op">&lt;-</span> <span class="va">ctd</span><span class="op">[[</span><span class="st">"QCFlag"</span><span class="op">]</span><span class="op">]</span> <span class="op">!=</span> <span class="fl">0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">[[</span><span class="st">"salinity"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">bad</span><span class="op">]</span>, <span class="va">ctd</span><span class="op">[[</span><span class="st">"theta"</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="va">bad</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="read.odf-2.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

