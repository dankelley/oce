<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Decimate a CTD profile — ctdDecimate • oce</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Decimate a CTD profile — ctdDecimate"><meta property="og:description" content="Interpolate a CTD profile to specified pressure values.  This is used
by sectionGrid(), but is also useful for dealing with individual
CTD/bottle profiles."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.5-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/oce.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dankelley/oce/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Decimate a CTD profile</h1>
    <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/ctd.R" class="external-link"><code>R/ctd.R</code></a></small>
    <div class="hidden name"><code>ctdDecimate.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Interpolate a CTD profile to specified pressure values.  This is used
by <code><a href="sectionGrid.html">sectionGrid()</a></code>, but is also useful for dealing with individual
CTD/bottle profiles.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">ctdDecimate</span><span class="op">(</span>
  <span class="va">x</span>,
  p <span class="op">=</span> <span class="fl">1</span>,
  method <span class="op">=</span> <span class="st">"boxcar"</span>,
  rule <span class="op">=</span> <span class="fl">1</span>,
  e <span class="op">=</span> <span class="fl">1.5</span>,
  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>a <a href="ctd-class.html">ctd</a> object.</p></dd>
<dt>p</dt>
<dd><p>pressure increment, or vector of pressures.  In the first case,
pressures from 0dbar to the rounded maximum pressure are used, incrementing by
<code>p</code> dbars.  If a vector of pressures is given, interpolation is done to
these pressures.</p></dd>
<dt>method</dt>
<dd><p>the method to be used for calculating decimated values.  This may
be a function or a string naming a built-in method.  The built-in methods are
as follows.</p><ul><li><p><code>"boxcar"</code> (based on a local average)</p></li>
<li><p><code>"approx"</code> (based on linear
interpolation between neighboring points, using <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code>
with the <code>rule</code> argument specified here)</p></li>
<li><p><code>"approxML"</code> as <code>"approx"</code>,
except that a mixed layer is assumed to apply above the top data value; this
is done by setting the <code>yleft</code> argument to <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code>, and
by calling that function with <code>rule=c(2,1))</code></p></li>
<li><p><code>"lm"</code> (based on local
regression, with <code>e</code> setting the size of the local region);</p></li>
<li><p><code>"rr"</code> for the Reiniger and Ross method, carried out with <code><a href="oceApprox.html">oce.approx()</a></code>;</p></li>
<li><p><code>"unesco"</code> (for the UNESCO method, carried out with <code><a href="oceApprox.html">oce.approx()</a></code>.</p></li>
</ul><p>On the other hand, if <code>method</code> is a function, then it must take
three arguments, the first being pressure, the second being an arbitrary
variable in another column of the data, and the third being a vector of target
pressures at which the calculation is carried out, and the return value must be
a vector.  See “Examples”.</p></dd>
<dt>rule</dt>
<dd><p>an integer that is passed to <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code>, in the
case where <code>method</code> is <code>"approx"</code>. Note that the default value
for <code>rule</code> is 1, which will inhibit extrapolation beyond the observed
pressure range. This is a change from the behaviour previous to May 8, 2017,
when a <code>rule</code> of 2 was used (without stating so as an argument).</p></dd>
<dt>e</dt>
<dd><p>is an expansion coefficient used to calculate the local neighbourhoods
for the <code>"boxcar"</code> and <code>"lm"</code> methods.  If <code>e=1</code>, then the
neighbourhood for the i-th pressure extends from the (<code>i-1</code>)-th pressure to
the (<code>i+1</code>)-th pressure.  At the endpoints it is assumed that the outside
bin is of the same pressure range as the first inside bin.  For other values of
<code>e</code>, the neighbourhood is expanded linearly in each direction.  If the
<code>"lm"</code> method produces warnings about "prediction from a rank-deficient
fit", a larger value of <code>"e"</code> should be used.</p></dd>
<dt>debug</dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A <a href="ctd-class.html">ctd</a> object, with pressures that are as set by
the <code>"p"</code> parameter and all other properties modified appropriately.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>"approx"</code> and <code>"approxML"</code> methods may be best for bottle data,
in which the usual task is
to interpolate from a coarse sampling grid to a finer one. The distinction
is that <code>"approxML"</code> assumes a mixed-layer above the top sample value. For CTD data, the
<code>"boxcar"</code> method may be the preferred choice, because the task is normally
to sub-sample, and some degree of smoothing is usually desired.  (The
<code>"lm"</code> method can be quite slow, and its results may be quite similar to those of the
boxcar method.)</p>
<p>For widely-spaced data, a sort of numerical cabeling effect can result when
density is computed based on interpolated salinity and temperature.
See reference 2 for a discussion of this issue and possible solutions.</p>
    </div>
    <div id="a-note-about-flags">
    <h2>A note about flags</h2>
    


<p>Data-quality flags contained within the original object are ignored by this
function, and the returned value contains no such flags.  This is because such
flags represent an assessment of the original data, not of quantities derived
from those data.  This function produces a warning to this effect. The
recommended practice is to use <code><a href="handleFlags.html">handleFlags()</a></code> or some other means to
deal with flags before calling the present function.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    
<ol><li><p>R.F. Reiniger and C.K. Ross, 1968.  A method of interpolation with
application to oceanographic data.  <em>Deep Sea Research</em>, <strong>15</strong>,
185-193.</p></li>
<li><p>Oguma, Sachiko, Toru Suzuki, Yutaka Nagata, Hidetoshi Watanabe, Hatsuyo Yamaguchi,
and Kimio Hanawa. “Interpolation Scheme for Standard Depth Data Applicable for Areas
with a Complex Hydrographical Structure.” Journal of Atmospheric and Oceanic Technology
21, no. 4 (April 1, 2004): 704-15.</p></li>
</ol></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>The documentation for <a href="ctd-class.html">ctd</a> explains the structure of
CTD objects, and also outlines the other functions dealing with them.</p>
<p>Other things related to ctd data: 
<code><a href="CTD_BCD2014666_008_1_DN.ODF.gz.html">CTD_BCD2014666_008_1_DN.ODF.gz</a></code>,
<code><a href="sub-sub-ctd-method.html">[[,ctd-method</a></code>,
<code>[[&lt;-,ctd-method</code>,
<code><a href="as.ctd.html">as.ctd</a>()</code>,
<code><a href="cnvName2oceName.html">cnvName2oceName</a>()</code>,
<code><a href="ctd-class.html">ctd-class</a></code>,
<code><a href="ctd.cnv.html">ctd.cnv</a></code>,
<code><a href="ctdFindProfiles.html">ctdFindProfiles</a>()</code>,
<code><a href="ctdRaw.html">ctdRaw</a></code>,
<code><a href="ctdRepair.html">ctdRepair</a>()</code>,
<code><a href="ctdTrim.html">ctdTrim</a>()</code>,
<code><a href="ctd.html">ctd</a></code>,
<code><a href="d200321-001.ctd.html">d200321-001.ctd</a></code>,
<code><a href="d201211_0011.cnv.html">d201211_0011.cnv</a></code>,
<code><a href="handleFlags-ctd-method.html">handleFlags,ctd-method</a></code>,
<code><a href="initialize-ctd-method.html">initialize,ctd-method</a></code>,
<code><a href="initializeFlagScheme-ctd-method.html">initializeFlagScheme,ctd-method</a></code>,
<code><a href="oceNames2whpNames.html">oceNames2whpNames</a>()</code>,
<code><a href="oceUnits2whpUnits.html">oceUnits2whpUnits</a>()</code>,
<code><a href="plot-ctd-method.html">plot,ctd-method</a></code>,
<code><a href="plotProfile.html">plotProfile</a>()</code>,
<code><a href="plotScan.html">plotScan</a>()</code>,
<code><a href="plotTS.html">plotTS</a>()</code>,
<code><a href="read.ctd.itp.html">read.ctd.itp</a>()</code>,
<code><a href="read.ctd.odf.html">read.ctd.odf</a>()</code>,
<code><a href="read.ctd.odv.html">read.ctd.odv</a>()</code>,
<code><a href="read.ctd.sbe.html">read.ctd.sbe</a>()</code>,
<code><a href="read.ctd.woce.other.html">read.ctd.woce.other</a>()</code>,
<code><a href="read.ctd.woce.html">read.ctd.woce</a>()</code>,
<code><a href="read.ctd.html">read.ctd</a>()</code>,
<code><a href="setFlags-ctd-method.html">setFlags,ctd-method</a></code>,
<code><a href="subset-ctd-method.html">subset,ctd-method</a></code>,
<code><a href="summary-ctd-method.html">summary,ctd-method</a></code>,
<code><a href="woceNames2oceNames.html">woceNames2oceNames</a>()</code>,
<code><a href="woceUnit2oceUnit.html">woceUnit2oceUnit</a>()</code>,
<code><a href="write.ctd.html">write.ctd</a>()</code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Dan Kelley</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="plotProfile.html">plotProfile</a></span><span class="op">(</span><span class="va">ctd</span>, <span class="st">"salinity"</span>, ylim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ctd2</span> <span class="op">&lt;-</span> <span class="fu">ctdDecimate</span><span class="op">(</span><span class="va">ctd</span>, p<span class="op">=</span><span class="va">p</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ctd2</span><span class="op">[[</span><span class="st">"salinity"</span><span class="op">]</span><span class="op">]</span>, <span class="va">ctd2</span><span class="op">[[</span><span class="st">"pressure"</span><span class="op">]</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">ctd3</span> <span class="op">&lt;-</span> <span class="fu">ctdDecimate</span><span class="op">(</span><span class="va">ctd</span>, p<span class="op">=</span><span class="va">p</span>, method<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">xout</span><span class="op">)</span></span>
<span class="r-in">                    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, df<span class="op">=</span><span class="fl">30</span><span class="op">)</span>, <span class="va">xout</span><span class="op">)</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ctd3</span><span class="op">[[</span><span class="st">"salinity"</span><span class="op">]</span><span class="op">]</span>, <span class="va">ctd3</span><span class="op">[[</span><span class="st">"pressure"</span><span class="op">]</span><span class="op">]</span>, col<span class="op">=</span><span class="st">"red"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="ctdDecimate-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer></div>

  


  

  </body></html>

