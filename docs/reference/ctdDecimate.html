<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Decimate a ctd Profile — ctdDecimate • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Decimate a ctd Profile — ctdDecimate"><meta name="description" content="Interpolate a CTD profile to specified pressure values.  This is used
by sectionGrid(), but is also useful for dealing with individual
CTD/bottle profiles."><meta property="og:description" content="Interpolate a CTD profile to specified pressure values.  This is used
by sectionGrid(), but is also useful for dealing with individual
CTD/bottle profiles."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
    <li><a class="dropdown-item" href="../articles/H_tides.html">8. Tidal Analysis</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Decimate a ctd Profile</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/ctd.R" class="external-link"><code>R/ctd.R</code></a></small>
      <div class="d-none name"><code>ctdDecimate.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Interpolate a CTD profile to specified pressure values.  This is used
by <code><a href="sectionGrid.html">sectionGrid()</a></code>, but is also useful for dealing with individual
CTD/bottle profiles.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ctdDecimate</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  p <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"boxcar"</span>,</span>
<span>  rule <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  e <span class="op">=</span> <span class="fl">1.5</span>,</span>
<span>  na.rm <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>a <a href="ctd-class.html">ctd</a> object.</p></dd>


<dt id="arg-p">p<a class="anchor" aria-label="anchor" href="#arg-p"></a></dt>
<dd><p>pressure increment, or vector of pressures.  In the first case,
pressures from 0dbar to the rounded maximum pressure are used, incrementing by
<code>p</code> dbars.  If a vector of pressures is given, interpolation is done to
these pressures.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>the method to be used for calculating decimated values.  This may
be a string specifying the method, or a function. In the string case, the
possibilities are as follows.</p><ul><li><p><code>"boxcar"</code> (based on a local average)</p></li>
<li><p><code>"approx"</code> (based on linear
interpolation between neighboring points, using <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code>
with the <code>rule</code> argument specified here)</p></li>
<li><p><code>"approxML"</code> as <code>"approx"</code>,
except that a mixed layer is assumed to apply above the top data value; this
is done by setting the <code>yleft</code> argument to <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code>, and
by calling that function with <code>rule=c(2, 1))</code></p></li>
<li><p><code>"lm"</code> (based on local
regression, with <code>e</code> setting the size of the local region);</p></li>
<li><p><code>"rr"</code> for the Reiniger and Ross method, carried out with <code><a href="oceApprox.html">oce.approx()</a></code>;</p></li>
<li><p><code>"unesco"</code> (for the UNESCO method, carried out with <code><a href="oceApprox.html">oce.approx()</a></code>.</p></li>
</ul><p>On the other hand, if <code>method</code> is a function, then it must take
two arguments, named <code>data</code> and <code>parameters</code>. The first is set to <code>x@data</code> by
<code><a href="ctdTrim.html">ctdTrim()</a></code>. The second is passed directly to the user's function (see
Example 2). The return value from the function must be a logical vector of
the same length as the <code>pressure</code> data, with TRUE values meaning to keep the
corresponding entries of the <code>data</code> slot.</p></dd>


<dt id="arg-rule">rule<a class="anchor" aria-label="anchor" href="#arg-rule"></a></dt>
<dd><p>an integer that is passed to <code><a href="https://rdrr.io/r/stats/approxfun.html" class="external-link">approx()</a></code>, in the
case where <code>method</code> is <code>"approx"</code>. Note that the default value
for <code>rule</code> is 1, which will inhibit extrapolation beyond the observed
pressure range. This is a change from the behaviour previous to May 8, 2017,
when a <code>rule</code> of 2 was used (without stating so as an argument).</p></dd>


<dt id="arg-e">e<a class="anchor" aria-label="anchor" href="#arg-e"></a></dt>
<dd><p>is an expansion coefficient used to calculate the local neighbourhoods
for the <code>"boxcar"</code> and <code>"lm"</code> methods.  If <code>e=1</code>, then the
neighbourhood for the i-th pressure extends from the (<code>i-1</code>)-th pressure to
the (<code>i+1</code>)-th pressure.  At the endpoints it is assumed that the outside
bin is of the same pressure range as the first inside bin.  For other values of
<code>e</code>, the neighbourhood is expanded linearly in each direction.  If the
<code>"lm"</code> method produces warnings about "prediction from a rank-deficient
fit", a larger value of <code>"e"</code> should be used.</p></dd>


<dt id="arg-na-rm">na.rm<a class="anchor" aria-label="anchor" href="#arg-na-rm"></a></dt>
<dd><p>logical value indicating whether to remove NA values
before decimating.  This value is ignored unless <code>method</code> is
<code>boxcar</code> in which case it is passed to <code><a href="binMean1D.html">binMean1D()</a></code> which does the
averaging. This parameter was added in February 2024, and the
behaviour of <code>ctdDecimate()</code> prior that date was equivalent
to <code>na.rm=FALSE</code>, so that is the default value, even though
it is expected that many uses will find using TRUE is more
convenient. See <code>https://github.com/dankelley/oce/issues/2192</code>
for more discussion.</p></dd>


<dt id="arg-debug">debug<a class="anchor" aria-label="anchor" href="#arg-debug"></a></dt>
<dd><p>an integer specifying whether debugging information is
to be printed during the processing. This is a general parameter that
is used by many <code>oce</code> functions. Generally, setting <code>debug=0</code>
turns off the printing, while higher values suggest that more information
be printed. If one function calls another, it usually reduces the value of
<code>debug</code> first, so that a user can often obtain deeper debugging
by specifying higher <code>debug</code> values.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="ctd-class.html">ctd</a> object, with pressures that are as set by
the <code>"p"</code> parameter and all other properties modified appropriately.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>"approx"</code> and <code>"approxML"</code> methods may be best for bottle data,
in which the usual task is
to interpolate from a coarse sampling grid to a finer one. The distinction
is that <code>"approxML"</code> assumes a mixed-layer above the top sample value. For CTD data, the
<code>"boxcar"</code> method may be the preferred choice, because the task is normally
to sub-sample, and some degree of smoothing is usually desired.  (The
<code>"lm"</code> method can be quite slow, and its results may be quite similar to those of the
boxcar method.)</p>
<p>For widely-spaced data, a sort of numerical cabeling effect can result when
density is computed based on interpolated salinity and temperature.
See reference 2 for a discussion of this issue and possible solutions.</p>
    </div>
    <div class="section level2">
    <h2 id="a-note-about-flags">A note about flags<a class="anchor" aria-label="anchor" href="#a-note-about-flags"></a></h2>



<p>Data-quality flags contained within the original object are ignored by this
function, and the returned value contains no such flags.  This is because such
flags represent an assessment of the original data, not of quantities derived
from those data.  This function produces a warning to this effect. The
recommended practice is to use <code><a href="handleFlags.html">handleFlags()</a></code> or some other means to
deal with flags before calling the present function.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ol><li><p>R.F. Reiniger and C.K. Ross, 1968.  A method of interpolation with
application to oceanographic data.  <em>Deep Sea Research</em>, <strong>15</strong>,
185-193.</p></li>
<li><p>Oguma, Sachiko, Toru Suzuki, Yutaka Nagata, Hidetoshi Watanabe, Hatsuyo Yamaguchi,
and Kimio Hanawa. “Interpolation Scheme for Standard Depth Data Applicable for Areas
with a Complex Hydrographical Structure.” Journal of Atmospheric and Oceanic Technology
21, no. 4 (April 1, 2004): 704-15.</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The documentation for <a href="ctd-class.html">ctd</a> explains the structure of
CTD objects, and also outlines the other functions dealing with them.</p>
<p>Other things related to ctd data:
<code><a href="CTD_BCD2014666_008_1_DN.ODF.gz.html">CTD_BCD2014666_008_1_DN.ODF.gz</a></code>,
<code><a href="sub-sub-ctd-method.html">[[,ctd-method</a></code>,
<code>[[&lt;-,ctd-method</code>,
<code><a href="argo2ctd.html">argo2ctd</a>()</code>,
<code><a href="as.ctd.html">as.ctd</a>()</code>,
<code><a href="cnvName2oceName.html">cnvName2oceName</a>()</code>,
<code><a href="ctd.html">ctd</a></code>,
<code><a href="ctd-class.html">ctd-class</a></code>,
<code><a href="ctd.cnv.gz.html">ctd.cnv.gz</a></code>,
<code><a href="ctdFindProfiles.html">ctdFindProfiles</a>()</code>,
<code><a href="ctdFindProfilesRBR.html">ctdFindProfilesRBR</a>()</code>,
<code><a href="ctdRaw.html">ctdRaw</a></code>,
<code><a href="ctdRepair.html">ctdRepair</a>()</code>,
<code><a href="ctdTrim.html">ctdTrim</a>()</code>,
<code><a href="ctd_aml_type1.csv.gz.html">ctd_aml_type1.csv.gz</a></code>,
<code><a href="ctd_aml_type3.csv.gz.html">ctd_aml_type3.csv.gz</a></code>,
<code><a href="d200321-001.ctd.gz.html">d200321-001.ctd.gz</a></code>,
<code><a href="d201211_0011.cnv.gz.html">d201211_0011.cnv.gz</a></code>,
<code><a href="handleFlags-ctd-method.html">handleFlags,ctd-method</a></code>,
<code><a href="initialize-ctd-method.html">initialize,ctd-method</a></code>,
<code><a href="initializeFlagScheme-ctd-method.html">initializeFlagScheme,ctd-method</a></code>,
<code><a href="oceNames2whpNames.html">oceNames2whpNames</a>()</code>,
<code><a href="oceUnits2whpUnits.html">oceUnits2whpUnits</a>()</code>,
<code><a href="plot-ctd-method.html">plot,ctd-method</a></code>,
<code><a href="plotProfile.html">plotProfile</a>()</code>,
<code><a href="plotScan.html">plotScan</a>()</code>,
<code><a href="plotTS.html">plotTS</a>()</code>,
<code><a href="read.ctd.html">read.ctd</a>()</code>,
<code><a href="read.ctd.aml.html">read.ctd.aml</a>()</code>,
<code><a href="read.ctd.itp.html">read.ctd.itp</a>()</code>,
<code><a href="read.ctd.odf.html">read.ctd.odf</a>()</code>,
<code><a href="read.ctd.odv.html">read.ctd.odv</a>()</code>,
<code><a href="read.ctd.saiv.html">read.ctd.saiv</a>()</code>,
<code><a href="read.ctd.sbe.html">read.ctd.sbe</a>()</code>,
<code><a href="read.ctd.ssda.html">read.ctd.ssda</a>()</code>,
<code><a href="read.ctd.woce.html">read.ctd.woce</a>()</code>,
<code><a href="read.ctd.woce.other.html">read.ctd.woce.other</a>()</code>,
<code><a href="setFlags-ctd-method.html">setFlags,ctd-method</a></code>,
<code><a href="subset-ctd-method.html">subset,ctd-method</a></code>,
<code><a href="summary-ctd-method.html">summary,ctd-method</a></code>,
<code><a href="woceNames2oceNames.html">woceNames2oceNames</a>()</code>,
<code><a href="woceUnit2oceUnit.html">woceUnit2oceUnit</a>()</code>,
<code><a href="write.ctd.html">write.ctd</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/">oce</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">ctd</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotProfile.html">plotProfile</a></span><span class="op">(</span><span class="va">ctd</span>, <span class="st">"salinity"</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ctd2</span> <span class="op">&lt;-</span> <span class="fu">ctdDecimate</span><span class="op">(</span><span class="va">ctd</span>, p <span class="op">=</span> <span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ctd2</span><span class="op">[[</span><span class="st">"salinity"</span><span class="op">]</span><span class="op">]</span>, <span class="va">ctd2</span><span class="op">[[</span><span class="st">"pressure"</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">45</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ctd3</span> <span class="op">&lt;-</span> <span class="fu">ctdDecimate</span><span class="op">(</span><span class="va">ctd</span>, p <span class="op">=</span> <span class="va">p</span>, method <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">xout</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/smooth.spline.html" class="external-link">smooth.spline</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, df <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>, <span class="va">xout</span><span class="op">)</span><span class="op">$</span><span class="va">y</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">ctd3</span><span class="op">[[</span><span class="st">"salinity"</span><span class="op">]</span><span class="op">]</span>, <span class="va">ctd3</span><span class="op">[[</span><span class="st">"pressure"</span><span class="op">]</span><span class="op">]</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="ctdDecimate-1.png" alt="" width="700" height="700"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

