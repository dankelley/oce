<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Set data-quality flags within a adp object — setFlags,adp-method • oce</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Set data-quality flags within a adp object — setFlags,adp-method"><meta property="og:description" content="This function changes specified entries in the data-quality
flags of a adp object, which are stored within
a list named flags that resides in the metadata
slot. If the object already has a flag set up for name,
then only the specified entries are altered. If not, the flag
entry is first created and its entries set to default,
after which the entries specified by i
are changed to value.
The specification is made with i, the form of which
is determined by the data item in question. Generally,
the rules are as follows:
If the data item is a vector, then i must be (a)
an integer vector specifying indices to be set to value,
(b) a logical vector of length matching the data item, with
TRUE meaning to set the flag to value, or (c)
a function that takes an oce object as its single
argument, and returns a vector in either of the forms
just described.
If the data item is an array, then i must be
(a) a data frame of integers whose rows specify spots to change
(where the number of columns matches the number of dimensions
of the data item), (b) a logical array that has dimension equal to
that of the data item, or (c) a function that takes an oce
object as its single input and returns such a data frame or array.


See &amp;#8220;Details&amp;#8221; for the particular case of adp objects."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">oce</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.7-0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/A_oce.html">1. Introduction to Oce</a>
    </li>
    <li>
      <a href="../articles/B_ctd.html">2. Analysis of CTD data</a>
    </li>
    <li>
      <a href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a>
    </li>
    <li>
      <a href="../articles/D_map_projections.html">4. Using map projections</a>
    </li>
    <li>
      <a href="../articles/E_flags.html">5. Dealing with data-quality flags</a>
    </li>
    <li>
      <a href="../articles/F_subclassing.html">6. Subclassing oce objects</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/dankelley/oce/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Set data-quality flags within a adp object</h1>
    <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/adp.R" class="external-link"><code>R/adp.R</code></a></small>
    <div class="hidden name"><code>setFlags-adp-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function changes specified entries in the data-quality
flags of a adp object, which are stored within
a list named <code>flags</code> that resides in the <code>metadata</code>
slot. If the object already has a flag set up for <code>name</code>,
then only the specified entries are altered. If not, the flag
entry is first created and its entries set to <code>default</code>,
after which the entries specified by <code>i</code>
are changed to <code>value</code>.</p>
<p>The specification is made with <code>i</code>, the form of which
is determined by the data item in question. Generally,
the rules are as follows:</p><ol><li><p>If the data item is a vector, then <code>i</code> must be (a)
an integer vector specifying indices to be set to <code>value</code>,
(b) a logical vector of length matching the data item, with
<code>TRUE</code> meaning to set the flag to <code>value</code>, or (c)
a function that takes an <code>oce</code> object as its single
argument, and returns a vector in either of the forms
just described.</p></li>
<li><p>If the data item is an array, then <code>i</code> must be
(a) a data frame of integers whose rows specify spots to change
(where the number of columns matches the number of dimensions
of the data item), (b) a logical array that has dimension equal to
that of the data item, or (c) a function that takes an <code>oce</code>
object as its single input and returns such a data frame or array.</p></li>
</ol><p>See “Details” for the particular case of <a href="adp-class.html">adp</a> objects.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for adp</span>
<span class="fu"><a href="setFlags.html">setFlags</a></span><span class="op">(</span>
  <span class="va">object</span>,
  name <span class="op">=</span> <span class="cn">NULL</span>,
  i <span class="op">=</span> <span class="cn">NULL</span>,
  value <span class="op">=</span> <span class="cn">NULL</span>,
  debug <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"oceDebug"</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An oce object.</p></dd>
<dt>name</dt>
<dd><p>Character string indicating the name of the variable to be flagged. If
this variable is not contained in the object's <code>data</code> slot, an error is reported.</p></dd>
<dt>i</dt>
<dd><p>Indication of where to insert the flags; see “Description” for
general rules and “Details” for rules for <a href="adp-class.html">adp</a>
objects.</p></dd>
<dt>value</dt>
<dd><p>The value to be inserted in the flag.</p></dd>
<dt>debug</dt>
<dd><p>Integer set to 0 for quiet action or to 1 for some debugging.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object with flags set as indicated.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The only flag that may be set is <code>v</code>, for the array holding velocity. See “Indexing rules”, noting that adp data are stored in 3D arrays; Example 1 shows using a data frame for <code>i</code>, while Example 2 shows using an array.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other functions relating to data-quality flags: 
<code><a href="defaultFlags.html">defaultFlags</a>()</code>,
<code><a href="handleFlags-adp-method.html">handleFlags,adp-method</a></code>,
<code><a href="handleFlags-argo-method.html">handleFlags,argo-method</a></code>,
<code><a href="handleFlags-ctd-method.html">handleFlags,ctd-method</a></code>,
<code><a href="handleFlags-oce-method.html">handleFlags,oce-method</a></code>,
<code><a href="handleFlags-section-method.html">handleFlags,section-method</a></code>,
<code><a href="handleFlags.html">handleFlags</a>()</code>,
<code><a href="initializeFlagScheme-ctd-method.html">initializeFlagScheme,ctd-method</a></code>,
<code><a href="initializeFlagScheme-oce-method.html">initializeFlagScheme,oce-method</a></code>,
<code><a href="initializeFlagScheme-section-method.html">initializeFlagScheme,section-method</a></code>,
<code><a href="initializeFlagSchemeInternal.html">initializeFlagSchemeInternal</a>()</code>,
<code><a href="initializeFlagScheme.html">initializeFlagScheme</a>()</code>,
<code><a href="initializeFlags-adp-method.html">initializeFlags,adp-method</a></code>,
<code><a href="initializeFlags-oce-method.html">initializeFlags,oce-method</a></code>,
<code><a href="initializeFlagsInternal.html">initializeFlagsInternal</a>()</code>,
<code><a href="initializeFlags.html">initializeFlags</a>()</code>,
<code><a href="setFlags-ctd-method.html">setFlags,ctd-method</a></code>,
<code><a href="setFlags-oce-method.html">setFlags,oce-method</a></code>,
<code><a href="setFlags.html">setFlags</a>()</code></p>
<p>Other things related to adp data: 
<code><a href="sub-sub-adp-method.html">[[,adp-method</a></code>,
<code>[[&lt;-,adp-method</code>,
<code><a href="ad2cpHeaderValue.html">ad2cpHeaderValue</a>()</code>,
<code><a href="adp-class.html">adp-class</a></code>,
<code><a href="adpConvertRawToNumeric.html">adpConvertRawToNumeric</a>()</code>,
<code><a href="adpEnsembleAverage.html">adpEnsembleAverage</a>()</code>,
<code><a href="adpFlagPastBoundary.html">adpFlagPastBoundary</a>()</code>,
<code><a href="adp_rdi.000.html">adp_rdi.000</a></code>,
<code><a href="adp.html">adp</a></code>,
<code><a href="as.adp.html">as.adp</a>()</code>,
<code><a href="beamName.html">beamName</a>()</code>,
<code><a href="beamToXyzAdpAD2CP.html">beamToXyzAdpAD2CP</a>()</code>,
<code><a href="beamToXyzAdp.html">beamToXyzAdp</a>()</code>,
<code><a href="beamToXyzAdv.html">beamToXyzAdv</a>()</code>,
<code><a href="beamToXyz.html">beamToXyz</a>()</code>,
<code><a href="beamUnspreadAdp.html">beamUnspreadAdp</a>()</code>,
<code><a href="binmapAdp.html">binmapAdp</a>()</code>,
<code><a href="enuToOtherAdp.html">enuToOtherAdp</a>()</code>,
<code><a href="enuToOther.html">enuToOther</a>()</code>,
<code><a href="handleFlags-adp-method.html">handleFlags,adp-method</a></code>,
<code><a href="is.ad2cp.html">is.ad2cp</a>()</code>,
<code><a href="plot-adp-method.html">plot,adp-method</a></code>,
<code><a href="read.adp.ad2cp.html">read.adp.ad2cp</a>()</code>,
<code><a href="read.adp.nortek.html">read.adp.nortek</a>()</code>,
<code><a href="read.adp.rdi.html">read.adp.rdi</a>()</code>,
<code><a href="read.adp.sontek.serial.html">read.adp.sontek.serial</a>()</code>,
<code><a href="read.adp.sontek.html">read.adp.sontek</a>()</code>,
<code><a href="read.adp.html">read.adp</a>()</code>,
<code><a href="read.aquadoppHR.html">read.aquadoppHR</a>()</code>,
<code><a href="read.aquadoppProfiler.html">read.aquadoppProfiler</a>()</code>,
<code><a href="read.aquadopp.html">read.aquadopp</a>()</code>,
<code><a href="rotateAboutZ.html">rotateAboutZ</a>()</code>,
<code><a href="subset-adp-method.html">subset,adp-method</a></code>,
<code><a href="subtractBottomVelocity.html">subtractBottomVelocity</a>()</code>,
<code><a href="summary-adp-method.html">summary,adp-method</a></code>,
<code><a href="toEnuAdp.html">toEnuAdp</a>()</code>,
<code><a href="toEnu.html">toEnu</a>()</code>,
<code><a href="velocityStatistics.html">velocityStatistics</a>()</code>,
<code><a href="xyzToEnuAdpAD2CP.html">xyzToEnuAdpAD2CP</a>()</code>,
<code><a href="xyzToEnuAdp.html">xyzToEnuAdp</a>()</code>,
<code><a href="xyzToEnu.html">xyzToEnu</a>()</code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dankelley.github.io/oce/" class="external-link">oce</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">adp</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example 1: flag first 10 samples in a mid-depth bin of beam 1</span></span>
<span class="r-in"><span class="va">i1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span>, <span class="fl">40</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adpQC</span> <span class="op">&lt;-</span> <span class="fu"><a href="initializeFlags.html">initializeFlags</a></span><span class="op">(</span><span class="va">adp</span>, <span class="st">"v"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adpQC</span> <span class="op">&lt;-</span> <span class="fu"><a href="setFlags.html">setFlags</a></span><span class="op">(</span><span class="va">adpQC</span>, <span class="st">"v"</span>, <span class="va">i1</span>, <span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adpClean1</span> <span class="op">&lt;-</span> <span class="fu"><a href="handleFlags.html">handleFlags</a></span><span class="op">(</span><span class="va">adpQC</span>, flags<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, actions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Top: original, bottom: altered</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adp</span>, which<span class="op">=</span><span class="st">"u1"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adpClean1</span>, which<span class="op">=</span><span class="st">"u1"</span><span class="op">)</span></span>
<span class="r-plt img"><img src="setFlags-adp-method-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co">## Example 2: percent-good and error-beam scheme</span></span>
<span class="r-in"><span class="va">v</span> <span class="op">&lt;-</span> <span class="va">adp</span><span class="op">[[</span><span class="st">"v"</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"><span class="va">i2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="cn">FALSE</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">v</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="va">g</span> <span class="op">&lt;-</span> <span class="va">adp</span><span class="op">[[</span><span class="st">"g"</span>, <span class="st">"numeric"</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-in"><span class="co"># Thresholds on percent "goodness" and error "velocity"</span></span>
<span class="r-in"><span class="va">G</span> <span class="op">&lt;-</span> <span class="fl">25</span></span>
<span class="r-in"><span class="va">V4</span> <span class="op">&lt;-</span> <span class="fl">0.45</span></span>
<span class="r-in"><span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span class="r-in">    <span class="va">i2</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">(</span><span class="va">g</span><span class="op">[</span>,,<span class="va">k</span><span class="op">]</span><span class="op">+</span><span class="va">g</span><span class="op">[</span>,,<span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;</span> <span class="va">G</span><span class="op">)</span> <span class="op">|</span> <span class="op">(</span><span class="va">v</span><span class="op">[</span>,,<span class="fl">4</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">V4</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adpQC2</span> <span class="op">&lt;-</span> <span class="fu"><a href="initializeFlags.html">initializeFlags</a></span><span class="op">(</span><span class="va">adp</span>, <span class="st">"v"</span>, <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adpQC2</span> <span class="op">&lt;-</span> <span class="fu"><a href="setFlags.html">setFlags</a></span><span class="op">(</span><span class="va">adpQC2</span>, <span class="st">"v"</span>, <span class="va">i2</span>, <span class="fl">3</span><span class="op">)</span></span>
<span class="r-in"><span class="va">adpClean2</span> <span class="op">&lt;-</span> <span class="fu"><a href="handleFlags.html">handleFlags</a></span><span class="op">(</span><span class="va">adpQC2</span>, flags<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span>, actions<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"NA"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-in"><span class="co">## Top: original, bottom: altered</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adp</span>, which<span class="op">=</span><span class="st">"u1"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">adpClean2</span>, which<span class="op">=</span><span class="st">"u1"</span><span class="op">)</span> <span class="co"># differs at 8h and 20h</span></span>
<span class="r-plt img"><img src="setFlags-adp-method-2.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

