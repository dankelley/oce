<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Solar Angle as Function of Space and Time — sunAngle • oce</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Solar Angle as Function of Space and Time — sunAngle"><meta name="description" content='This calculates solar angle, based on a NASA-provided Fortran
program, which (according to comments in the code) is in turn
based on "The Astronomical Almanac".
Note that time may be a single value or a vector
of values; in the latter case, longitude, latitude and useRefraction
are all made to be of the same length as time, by calling rep(). This
addresses the case of finding a time-series of angles at a given spatial
location. For other cases of arguments that are not single values,
either call sunAngle() repeatedly or, if that is too slow,
use expand.grid() to set up values of uniform length that
are then supplied to sunAngle().'><meta property="og:description" content='This calculates solar angle, based on a NASA-provided Fortran
program, which (according to comments in the code) is in turn
based on "The Astronomical Almanac".
Note that time may be a single value or a vector
of values; in the latter case, longitude, latitude and useRefraction
are all made to be of the same length as time, by calling rep(). This
addresses the case of finding a time-series of angles at a given spatial
location. For other cases of arguments that are not single values,
either call sunAngle() repeatedly or, if that is too slow,
use expand.grid() to set up values of uniform length that
are then supplied to sunAngle().'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">oce</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.8-4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/A_oce.html">1. Introduction to Oce</a></li>
    <li><a class="dropdown-item" href="../articles/B_ctd.html">2. Analysis of CTD data</a></li>
    <li><a class="dropdown-item" href="../articles/C_adp.html">3. Analysis of acoustic-Doppler data</a></li>
    <li><a class="dropdown-item" href="../articles/D_map_projections.html">4. Using map projections</a></li>
    <li><a class="dropdown-item" href="../articles/E_flags.html">5. Dealing with data-quality flags</a></li>
    <li><a class="dropdown-item" href="../articles/F_subclassing.html">6. Subclassing oce objects</a></li>
    <li><a class="dropdown-item" href="../articles/G_altering_defaults.html">7. Altering oce Defaults</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dankelley/oce/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Solar Angle as Function of Space and Time</h1>
      <small class="dont-index">Source: <a href="https://github.com/dankelley/oce/blob/HEAD/R/sun.R" class="external-link"><code>R/sun.R</code></a></small>
      <div class="d-none name"><code>sunAngle.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This calculates solar angle, based on a NASA-provided Fortran
program, which (according to comments in the code) is in turn
based on "The Astronomical Almanac".
Note that <code>time</code> may be a single value or a vector
of values; in the latter case, <code>longitude</code>, <code>latitude</code> and <code>useRefraction</code>
are all made to be of the same length as <code>time</code>, by calling <code><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep()</a></code>. This
addresses the case of finding a time-series of angles at a given spatial
location. For other cases of arguments that are not single values,
either call <code>sunAngle()</code> repeatedly or, if that is too slow,
use <code><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid()</a></code> to set up values of uniform length that
are then supplied to <code>sunAngle()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sunAngle</span><span class="op">(</span><span class="va">t</span>, longitude <span class="op">=</span> <span class="fl">0</span>, latitude <span class="op">=</span> <span class="fl">0</span>, useRefraction <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>time, either a POSIXt object (converted to timezone <code>"UTC"</code>,
if it is not already in that timezone), or a value (character or numeric)
that can be converted to a time with <code><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct()</a></code>, assuming the
timezone to be <code>"UTC"</code>.</p></dd>


<dt id="arg-longitude">longitude<a class="anchor" aria-label="anchor" href="#arg-longitude"></a></dt>
<dd><p>observer longitude in degrees east.</p></dd>


<dt id="arg-latitude">latitude<a class="anchor" aria-label="anchor" href="#arg-latitude"></a></dt>
<dd><p>observer latitude in degrees north.</p></dd>


<dt id="arg-userefraction">useRefraction<a class="anchor" aria-label="anchor" href="#arg-userefraction"></a></dt>
<dd><p>boolean, set to <code>TRUE</code> to apply a correction for
atmospheric refraction.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing the following:</p><ul><li><p><code>time</code> the time</p></li>
<li><p><code>azimuth</code>, in degrees eastward of north, from 0 to 360.</p></li>
<li><p><code>altitude</code>, in degrees above the horizon,  ranging from -90 to 90.</p></li>
<li><p><code>diameter</code>, solar diameter, in degrees.</p></li>
<li><p><code>distance</code> to sun, in astronomical units.</p></li>
<li><p><code>declination</code> angle in degrees, computed with <code><a href="sunDeclinationRightAscension.html">sunDeclinationRightAscension()</a></code>.</p></li>
<li><p><code>rightAscension</code> angle in degrees, computed with <code><a href="sunDeclinationRightAscension.html">sunDeclinationRightAscension()</a></code>.
<img src="figures/starCoords.png" width="400"></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Regarding <code>declination</code> and <code>rightAscension</code>, see
references in the documentation for <code><a href="sunDeclinationRightAscension.html">sunDeclinationRightAscension()</a></code>.
The other items are based on Fortran code retrieved from
the file <code>sunae.f</code>, downloaded from the ftp site
<code>climate1.gsfc.nasa.gov/wiscombe/Solar_Rad/SunAngles</code>
on 2009-11-1.  Comments in that code list as references:</p>
<p>Michalsky, J., 1988: The Astronomical Almanac's algorithm for approximate
solar position (1950-2050), Solar Energy 40, 227-235</p>
<p>The Astronomical Almanac, U.S. Gov't Printing Office, Washington, D.C.
(published every year).</p>
<p>The code comments suggest that the appendix in Michalsky (1988) contains
errors, and declares the use of the following formulae in the 1995 version
the Almanac:</p><ul><li><p>p. A12: approximation to sunrise/set times</p></li>
<li><p>p. B61: solar altitude (AKA elevation) and azimuth</p></li>
<li><p>p. B62: refraction correction</p></li>
<li><p>p. C24: mean longitude, mean anomaly, ecliptic
longitude, obliquity of ecliptic, right ascension, declination, Earth-Sun
distance, angular diameter of Sun</p></li>
<li><p>p. L2: Greenwich mean sidereal time (ignoring T^2, T^3 terms)</p></li>
</ul><p>The code lists authors as Dr. Joe Michalsky and Dr. Lee Harrison (State
University of New York), with modifications by Dr. Warren Wiscombe (NASA
Goddard Space Flight Center).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>The corresponding function for the moon is <code><a href="moonAngle.html">moonAngle()</a></code>.</p>
<p>Other things related to astronomy:
<code><a href="angle2hms.html">angle2hms</a>()</code>,
<code><a href="eclipticalToEquatorial.html">eclipticalToEquatorial</a>()</code>,
<code><a href="equatorialToLocalHorizontal.html">equatorialToLocalHorizontal</a>()</code>,
<code><a href="julianCenturyAnomaly.html">julianCenturyAnomaly</a>()</code>,
<code><a href="julianDay.html">julianDay</a>()</code>,
<code><a href="moonAngle.html">moonAngle</a>()</code>,
<code><a href="siderealTime.html">siderealTime</a>()</code>,
<code><a href="sunDeclinationRightAscension.html">sunDeclinationRightAscension</a>()</code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Dan Kelley</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2011-03-03 06:49:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">4</span> <span class="op">*</span> <span class="fl">3600</span></span></span>
<span class="r-in"><span><span class="va">set</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.POSIXlt.html" class="external-link">as.POSIXct</a></span><span class="op">(</span><span class="st">"2011-03-03 18:04:00"</span>, tz <span class="op">=</span> <span class="st">"UTC"</span><span class="op">)</span> <span class="op">+</span> <span class="fl">4</span> <span class="op">*</span> <span class="fl">3600</span></span></span>
<span class="r-in"><span><span class="va">mismatch</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">lonlat</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="fu">sunAngle</span><span class="op">(</span><span class="va">rise</span>, <span class="va">lonlat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lonlat</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">altitude</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu">sunAngle</span><span class="op">(</span><span class="va">set</span>, <span class="va">lonlat</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">lonlat</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span><span class="op">$</span><span class="va">altitude</span><span class="op">^</span><span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="va">mismatch</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lonHfx</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">63.55274</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">latHfx</span> <span class="op">&lt;-</span> <span class="fl">44.65</span></span></span>
<span class="r-in"><span><span class="va">dist</span> <span class="op">&lt;-</span> <span class="fu"><a href="geodDist.html">geodDist</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">result</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">lonHfx</span>, <span class="va">latHfx</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Infer Halifax latitude %.2f and longitude %.2f; distance mismatch %.0f km"</span>,</span></span>
<span class="r-in"><span>    <span class="va">result</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">result</span><span class="op">$</span><span class="va">par</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">dist</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Infer Halifax latitude 39.44 and longitude -63.56; distance mismatch 579 km</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Dan Kelley, Clark Richards.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

